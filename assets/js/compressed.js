/*!
 * abbeyload.js
 * A music asset loader by Stuart Memo 
 */
!function(a,b){a.AudioContext=a.AudioContext||a.webkitAudioContext;var c=0,d=0,e=new AudioContext,g=function(a,b,e){this.files=a||{},c=0,d=0,i(this.files,b,e)};g.size=function(a){var b=0;for(var c in a)a.hasOwnProperty(c)&&b++;return b};var h=function(a,b,f,h,i){var j=new XMLHttpRequest;j.open("GET",b[a],!0),j.responseType="arraybuffer",j.onload=function(){c++,e.decodeAudioData(j.response,function(b){f[a]=b,"function"==typeof i&&i(100*g.size(f)/d),g.size(f)===d&&h(f)})},j.send()},i=function(a,b,c){var e={};a.forEach(function(a,f){d=g.size(a);for(var i in a)a.hasOwnProperty(i)&&h(i,a,e,b,c)})};a.AbbeyLoad=g}(window);


/*!
 * classie v1.0.1
 * class helper functions
 * from bonzo https://github.com/ded/bonzo
 * MIT license
 * 
 * classie.has( elem, 'my-class' ) -> true/false
 * classie.add( elem, 'my-new-class' )
 * classie.remove( elem, 'my-unwanted-class' )
 * classie.toggle( elem, 'my-class' )
 */
!function(a){"use strict";function b(a){return new RegExp("(^|\\s+)"+a+"(\\s+|$)")}function f(a,b){var f=c(a,b)?e:d;f(a,b)}var c,d,e;"classList"in document.documentElement?(c=function(a,b){return a.classList.contains(b)},d=function(a,b){a.classList.add(b)},e=function(a,b){a.classList.remove(b)}):(c=function(a,c){return b(c).test(a.className)},d=function(a,b){c(a,b)||(a.className=a.className+" "+b)},e=function(a,c){a.className=a.className.replace(b(c)," ")});var g={hasClass:c,addClass:d,removeClass:e,toggleClass:f,has:c,add:d,remove:e,toggle:f};"function"==typeof define&&define.amd?define(g):"object"==typeof exports?module.exports=g:a.classie=g}(window);


/*!
 * dynamics
 */
(function(){var t,e,n,r,o,i,s,a,u,l,f,h,p,c,m,d,g,y,v,b,w,x,M,S,k,T,C,H,R,q,X,I,Y,j,z,F,G,A,O,V,Z,E,L,D,P,W,N,U,$,B,K,J,Q,_,te,ee,ne,re=function(t,e){return function(){return t.apply(e,arguments)}};q=function(){return"visible"===document.visibilityState||null!=C.tests},z=function(){var t;return t=[],"undefined"!=typeof document&&null!==document&&document.addEventListener("visibilitychange",function(){var e,n,r,o;for(o=[],n=0,r=t.length;r>n;n++)e=t[n],o.push(e(q()));return o}),function(e){return t.push(e)}}(),M=function(t){var e,n,r;n={};for(e in t)r=t[e],n[e]=r;return n},w=function(t){var e;return e={},function(){var n,r,o,i,s;for(r="",i=0,s=arguments.length;s>i;i++)n=arguments[i],r+=n.toString()+",";return o=e[r],o||(e[r]=o=t.apply(this,arguments)),o}},j=function(t){return function(e){var n,r,o;return e instanceof Array||e instanceof NodeList||e instanceof HTMLCollection?o=function(){var o,i,s;for(s=[],r=o=0,i=e.length;i>=0?i>o:o>i;r=i>=0?++o:--o)n=Array.prototype.slice.call(arguments,1),n.splice(0,0,e[r]),s.push(t.apply(this,n));return s}.apply(this,arguments):t.apply(this,arguments)}},g=function(t,e){var n,r,o;o=[];for(n in e)r=e[n],o.push(null!=t[n]?t[n]:t[n]=r);return o},y=function(t,e){var n,r,o;if(null!=t.style)return v(t,e);o=[];for(n in e)r=e[n],o.push(t[n]=r.format());return o},v=function(t,e){var n,r,o,i,s;e=F(e),i=[],n=X(t);for(r in e)s=e[r],te.contains(r)?i.push([r,s]):(null!=s.format&&(s=s.format()),"number"==typeof s&&(s=""+s+ne(r,s)),n&&B.contains(r)?t.setAttribute(r,s):t.style[A(r)]=s);return i.length>0?n?(o=new l,o.applyProperties(i),t.setAttribute("transform",o.decompose().format())):(s=i.map(function(t){return ee(t[0],t[1])}).join(" "),t.style[A("transform")]=s):void 0},X=function(t){var e,n;return"undefined"!=typeof SVGElement&&null!==SVGElement&&"undefined"!=typeof SVGSVGElement&&null!==SVGSVGElement?t instanceof SVGElement&&!(t instanceof SVGSVGElement):null!=(e=null!=(n=C.tests)&&"function"==typeof n.isSVG?n.isSVG(t):void 0)?e:!1},Z=function(t,e){var n;return n=Math.pow(10,e),Math.round(t*n)/n},f=function(){function t(t){var e,n,r;for(this.obj={},n=0,r=t.length;r>n;n++)e=t[n],this.obj[e]=1}return t.prototype.contains=function(t){return 1===this.obj[t]},t}(),_=function(t){return t.replace(/([A-Z])/g,function(t){return"-"+t.toLowerCase()})},O=new f("marginTop,marginLeft,marginBottom,marginRight,paddingTop,paddingLeft,paddingBottom,paddingRight,top,left,bottom,right,translateX,translateY,translateZ,perspectiveX,perspectiveY,perspectiveZ,width,height,maxWidth,maxHeight,minWidth,minHeight,borderRadius".split(",")),T=new f("rotate,rotateX,rotateY,rotateZ,skew,skewX,skewY,skewZ".split(",")),te=new f("translate,translateX,translateY,translateZ,scale,scaleX,scaleY,scaleZ,rotate,rotateX,rotateY,rotateZ,rotateC,rotateCX,rotateCY,skew,skewX,skewY,skewZ,perspective".split(",")),B=new f("accent-height,ascent,azimuth,baseFrequency,baseline-shift,bias,cx,cy,d,diffuseConstant,divisor,dx,dy,elevation,filterRes,fx,fy,gradientTransform,height,k1,k2,k3,k4,kernelMatrix,kernelUnitLength,letter-spacing,limitingConeAngle,markerHeight,markerWidth,numOctaves,order,overline-position,overline-thickness,pathLength,points,pointsAtX,pointsAtY,pointsAtZ,r,radius,rx,ry,seed,specularConstant,specularExponent,stdDeviation,stop-color,stop-opacity,strikethrough-position,strikethrough-thickness,surfaceScale,target,targetX,targetY,transform,underline-position,underline-thickness,viewBox,width,x,x1,x2,y,y1,y2,z".split(",")),ne=function(t,e){return"number"!=typeof e?"":O.contains(t)?"px":T.contains(t)?"deg":""},ee=function(t,e){var n,r;return n=(""+e).match(/^([0-9.-]*)([^0-9]*)$/),null!=n?(e=n[1],r=n[2]):e=parseFloat(e),e=Z(parseFloat(e),10),(null==r||""===r)&&(r=ne(t,e)),""+t+"("+e+r+")"},F=function(t){var e,n,r,o,i,s,a,u;r={};for(o in t)if(i=t[o],te.contains(o))if(n=o.match(/(translate|rotateC|rotate|skew|scale|perspective)(X|Y|Z|)/),n&&n[2].length>0)r[o]=i;else for(u=["X","Y","Z"],s=0,a=u.length;a>s;s++)e=u[s],r[n[1]+e]=i;else r[o]=i;return r},k=function(t){var e;return e="opacity"===t?1:0,""+e+ne(t,e)},H=function(t,e){var n,r,o,i,s,a,f,h,p,c,m;if(i={},n=X(t),null!=t.style)for(s=window.getComputedStyle(t,null),f=0,p=e.length;p>f;f++)r=e[f],te.contains(r)?null==i.transform&&(o=n?new l(null!=(m=t.transform.baseVal.consolidate())?m.matrix:void 0):u.fromTransform(s[A("transform")]),i.transform=o.decompose()):(a=s[r],null==a&&B.contains(r)&&(a=t.getAttribute(r)),(""===a||null==a)&&(a=k(r)),i[r]=S(a));else for(h=0,c=e.length;c>h;h++)r=e[h],i[r]=S(t[r]);return i},S=function(t){var e,n,o,u,l;for(o=[r,s,i,a],u=0,l=o.length;l>u;u++)if(n=o[u],e=n.create(t),null!=e)return e;return null},a=function(){function t(t){this.parts=t,this.format=re(this.format,this),this.interpolate=re(this.interpolate,this)}return t.prototype.interpolate=function(e,n){var r,o,i,s,a,u;for(s=this.parts,r=e.parts,i=[],o=a=0,u=Math.min(s.length,r.length);u>=0?u>a:a>u;o=u>=0?++a:--a)i.push(null!=s[o].interpolate?s[o].interpolate(r[o],n):s[o]);return new t(i)},t.prototype.format=function(){var t;return t=this.parts.map(function(t){return null!=t.format?t.format():t}),t.join("")},t.create=function(e){var n,r,s,a,u,l,f,h,p,c,m;for(e=""+e,s=[],f=[{re:/(#[a-f\d]{3,6})/gi,klass:o,parse:function(t){return t}},{re:/(rgba?\([0-9.]*, ?[0-9.]*, ?[0-9.]*(?:, ?[0-9.]*)?\))/gi,klass:o,parse:function(t){return t}},{re:/([-+]?[\d.]+)/gi,klass:i,parse:parseFloat}],h=0,c=f.length;c>h;h++)for(l=f[h],u=l.re;r=u.exec(e);)s.push({index:r.index,length:r[1].length,interpolable:l.klass.create(l.parse(r[1]))});for(s=s.sort(function(t,e){return t.index>e.index?1:-1}),a=[],n=0,p=0,m=s.length;m>p;p++)r=s[p],r.index<n||(r.index>n&&a.push(e.substring(n,r.index)),a.push(r.interpolable),n=r.index+r.length);return n<e.length&&a.push(e.substring(n)),new t(a)},t}(),s=function(){function t(t){this.format=re(this.format,this),this.interpolate=re(this.interpolate,this),this.obj=t}return t.prototype.interpolate=function(e,n){var r,o,i,s,a;s=this.obj,r=e.obj,i={};for(o in s)a=s[o],i[o]=null!=a.interpolate?a.interpolate(r[o],n):a;return new t(i)},t.prototype.format=function(){return this.obj},t.create=function(e){var n,r,o;if(e instanceof Object){r={};for(n in e)o=e[n],r[n]=S(o);return new t(r)}return null},t}(),i=function(){function t(t){this.format=re(this.format,this),this.interpolate=re(this.interpolate,this),this.value=parseFloat(t)}return t.prototype.interpolate=function(e,n){var r,o;return o=this.value,r=e.value,new t((r-o)*n+o)},t.prototype.format=function(){return Z(this.value,5)},t.create=function(e){return"number"==typeof e?new t(e):null},t}(),r=function(){function t(t){this.values=t,this.format=re(this.format,this),this.interpolate=re(this.interpolate,this)}return t.prototype.interpolate=function(e,n){var r,o,i,s,a,u;for(s=this.values,r=e.values,i=[],o=a=0,u=Math.min(s.length,r.length);u>=0?u>a:a>u;o=u>=0?++a:--a)i.push(null!=s[o].interpolate?s[o].interpolate(r[o],n):s[o]);return new t(i)},t.prototype.format=function(){return this.values.map(function(t){return null!=t.format?t.format():t})},t.createFromArray=function(e){var n;return n=e.map(function(t){return S(t)||t}),n=n.filter(function(t){return null!=t}),new t(n)},t.create=function(e){return e instanceof Array?t.createFromArray(e):null},t}(),t=function(){function t(t,e){this.rgb=null!=t?t:{},this.format=e,this.toRgba=re(this.toRgba,this),this.toRgb=re(this.toRgb,this),this.toHex=re(this.toHex,this)}return t.fromHex=function(e){var n,r;return n=e.match(/^#([a-f\d]{1})([a-f\d]{1})([a-f\d]{1})$/i),null!=n&&(e="#"+n[1]+n[1]+n[2]+n[2]+n[3]+n[3]),r=e.match(/^#([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i),null!=r?new t({r:parseInt(r[1],16),g:parseInt(r[2],16),b:parseInt(r[3],16),a:1},"hex"):null},t.fromRgb=function(e){var n,r;return n=e.match(/^rgba?\(([0-9.]*), ?([0-9.]*), ?([0-9.]*)(?:, ?([0-9.]*))?\)$/),null!=n?new t({r:parseFloat(n[1]),g:parseFloat(n[2]),b:parseFloat(n[3]),a:parseFloat(null!=(r=n[4])?r:1)},null!=n[4]?"rgba":"rgb"):null},t.componentToHex=function(t){var e;return e=t.toString(16),1===e.length?"0"+e:e},t.prototype.toHex=function(){return"#"+t.componentToHex(this.rgb.r)+t.componentToHex(this.rgb.g)+t.componentToHex(this.rgb.b)},t.prototype.toRgb=function(){return"rgb("+this.rgb.r+", "+this.rgb.g+", "+this.rgb.b+")"},t.prototype.toRgba=function(){return"rgba("+this.rgb.r+", "+this.rgb.g+", "+this.rgb.b+", "+this.rgb.a+")"},t}(),o=function(){function e(t){this.color=t,this.format=re(this.format,this),this.interpolate=re(this.interpolate,this)}return e.prototype.interpolate=function(n,r){var o,i,s,a,u,l,f,h;for(a=this.color,o=n.color,s={},h=["r","g","b"],l=0,f=h.length;f>l;l++)i=h[l],u=Math.round((o.rgb[i]-a.rgb[i])*r+a.rgb[i]),s[i]=Math.min(255,Math.max(0,u));return i="a",u=Z((o.rgb[i]-a.rgb[i])*r+a.rgb[i],5),s[i]=Math.min(1,Math.max(0,u)),new e(new t(s,o.format))},e.prototype.format=function(){return"hex"===this.color.format?this.color.toHex():"rgb"===this.color.format?this.color.toRgb():"rgba"===this.color.format?this.color.toRgba():void 0},e.create=function(n){var r;if("string"==typeof n)return r=t.fromHex(n)||t.fromRgb(n),null!=r?new e(r):null},e}(),n=function(){function t(t){this.props=t,this.applyRotateCenter=re(this.applyRotateCenter,this),this.format=re(this.format,this),this.interpolate=re(this.interpolate,this)}return t.prototype.interpolate=function(e,n){var r,o,i,s,a,u,l,f,h,p,c,m;for(i={},p=["translate","scale","rotate"],s=0,f=p.length;f>s;s++)for(o=p[s],i[o]=[],r=a=0,c=this.props[o].length;c>=0?c>a:a>c;r=c>=0?++a:--a)i[o][r]=(e.props[o][r]-this.props[o][r])*n+this.props[o][r];for(r=u=1;2>=u;r=++u)i.rotate[r]=e.props.rotate[r];for(m=["skew"],l=0,h=m.length;h>l;l++)o=m[l],i[o]=(e.props[o]-this.props[o])*n+this.props[o];return new t(i)},t.prototype.format=function(){return"translate("+this.props.translate.join(",")+") rotate("+this.props.rotate.join(",")+") skewX("+this.props.skew+") scale("+this.props.scale.join(",")+")"},t.prototype.applyRotateCenter=function(t){var e,n,r,o,i,s;for(n=b.createSVGMatrix(),n=n.translate(t[0],t[1]),n=n.rotate(this.props.rotate[0]),n=n.translate(-t[0],-t[1]),r=new l(n),o=r.decompose().props.translate,s=[],e=i=0;1>=i;e=++i)s.push(this.props.translate[e]-=o[e]);return s},t}(),b="undefined"!=typeof document&&null!==document?document.createElementNS("http://www.w3.org/2000/svg","svg"):void 0,l=function(){function t(t){this.m=t,this.applyProperties=re(this.applyProperties,this),this.decompose=re(this.decompose,this),this.m||(this.m=b.createSVGMatrix())}return t.prototype.decompose=function(){var t,e,r,o,i;return o=new h([this.m.a,this.m.b]),i=new h([this.m.c,this.m.d]),t=o.length(),r=o.dot(i),o=o.normalize(),e=i.combine(o,1,-r).length(),new n({translate:[this.m.e,this.m.f],rotate:[180*Math.atan2(this.m.b,this.m.a)/Math.PI,this.rotateCX,this.rotateCY],scale:[t,e],skew:r/e*180/Math.PI})},t.prototype.applyProperties=function(t){var e,n,r,o,i,s,a,u;for(e={},i=0,s=t.length;s>i;i++)r=t[i],e[r[0]]=r[1];for(n in e)o=e[n],"translateX"===n?this.m=this.m.translate(o,0):"translateY"===n?this.m=this.m.translate(0,o):"scaleX"===n?this.m=this.m.scaleNonUniform(o,1):"scaleY"===n?this.m=this.m.scaleNonUniform(1,o):"rotateZ"===n?this.m=this.m.rotate(o):"skewX"===n?this.m=this.m.skewX(o):"skewY"===n&&(this.m=this.m.skewY(o));return this.rotateCX=null!=(a=e.rotateCX)?a:0,this.rotateCY=null!=(u=e.rotateCY)?u:0},t}(),h=function(){function t(t){this.els=t,this.combine=re(this.combine,this),this.normalize=re(this.normalize,this),this.length=re(this.length,this),this.cross=re(this.cross,this),this.dot=re(this.dot,this),this.e=re(this.e,this)}return t.prototype.e=function(t){return 1>t||t>this.els.length?null:this.els[t-1]},t.prototype.dot=function(t){var e,n,r;if(e=t.els||t,r=0,n=this.els.length,n!==e.length)return null;for(n+=1;--n;)r+=this.els[n-1]*e[n-1];return r},t.prototype.cross=function(e){var n,r;return r=e.els||e,3!==this.els.length||3!==r.length?null:(n=this.els,new t([n[1]*r[2]-n[2]*r[1],n[2]*r[0]-n[0]*r[2],n[0]*r[1]-n[1]*r[0]]))},t.prototype.length=function(){var t,e,n,r,o;for(t=0,o=this.els,n=0,r=o.length;r>n;n++)e=o[n],t+=Math.pow(e,2);return Math.sqrt(t)},t.prototype.normalize=function(){var e,n,r,o,i;r=this.length(),o=[],i=this.els;for(n in i)e=i[n],o[n]=e/r;return new t(o)},t.prototype.combine=function(e,n,r){var o,i,s,a;for(i=[],o=s=0,a=this.els.length;a>=0?a>s:s>a;o=a>=0?++s:--s)i[o]=n*this.els[o]+r*e.els[o];return new t(i)},t}(),e=function(){function t(){this.toMatrix=re(this.toMatrix,this),this.format=re(this.format,this),this.interpolate=re(this.interpolate,this)}return t.prototype.interpolate=function(e,n,r){var o,i,s,a,u,l,f,h,p,c,m,d,g,y,v,b,w,x;for(null==r&&(r=null),s=this,i=new t,w=["translate","scale","skew","perspective"],d=0,b=w.length;b>d;d++)for(f=w[d],i[f]=[],a=g=0,x=s[f].length-1;x>=0?x>=g:g>=x;a=x>=0?++g:--g)i[f][a]=null==r||r.indexOf(f)>-1||r.indexOf(""+f+["x","y","z"][a])>-1?(e[f][a]-s[f][a])*n+s[f][a]:s[f][a];if(null==r||-1!==r.indexOf("rotate")){if(h=s.quaternion,p=e.quaternion,o=h[0]*p[0]+h[1]*p[1]+h[2]*p[2]+h[3]*p[3],0>o){for(a=y=0;3>=y;a=++y)h[a]=-h[a];o=-o}for(o+1>.05?1-o>=.05?(m=Math.acos(o),l=1/Math.sin(m),c=Math.sin(m*(1-n))*l,u=Math.sin(m*n)*l):(c=1-n,u=n):(p[0]=-h[1],p[1]=h[0],p[2]=-h[3],p[3]=h[2],c=Math.sin(piDouble*(.5-n)),u=Math.sin(piDouble*n)),i.quaternion=[],a=v=0;3>=v;a=++v)i.quaternion[a]=h[a]*c+p[a]*u}else i.quaternion=s.quaternion;return i},t.prototype.format=function(){return this.toMatrix().toString()},t.prototype.toMatrix=function(){var t,e,n,r,o,i,s,a,l,f,h,p,c,m,d,g;for(t=this,o=u.I(4),e=c=0;3>=c;e=++c)o.els[e][3]=t.perspective[e];for(i=t.quaternion,f=i[0],h=i[1],p=i[2],l=i[3],s=t.skew,r=[[1,0],[2,0],[2,1]],e=m=2;m>=0;e=--m)s[e]&&(a=u.I(4),a.els[r[e][0]][r[e][1]]=s[e],o=o.multiply(a));for(o=o.multiply(new u([[1-2*(h*h+p*p),2*(f*h-p*l),2*(f*p+h*l),0],[2*(f*h+p*l),1-2*(f*f+p*p),2*(h*p-f*l),0],[2*(f*p-h*l),2*(h*p+f*l),1-2*(f*f+h*h),0],[0,0,0,1]])),e=d=0;2>=d;e=++d){for(n=g=0;2>=g;n=++g)o.els[e][n]*=t.scale[e];o.els[3][e]=t.translate[e]}return o},t}(),u=function(){function t(t){this.els=t,this.toString=re(this.toString,this),this.decompose=re(this.decompose,this),this.inverse=re(this.inverse,this),this.augment=re(this.augment,this),this.toRightTriangular=re(this.toRightTriangular,this),this.transpose=re(this.transpose,this),this.multiply=re(this.multiply,this),this.dup=re(this.dup,this),this.e=re(this.e,this)}return t.prototype.e=function(t,e){return 1>t||t>this.els.length||1>e||e>this.els[0].length?null:this.els[t-1][e-1]},t.prototype.dup=function(){return new t(this.els)},t.prototype.multiply=function(e){var n,r,o,i,s,a,u,l,f,h,p,c,m;for(c=e.modulus?!0:!1,n=e.els||e,"undefined"==typeof n[0][0]&&(n=new t(n).els),h=this.els.length,u=h,l=n[0].length,o=this.els[0].length,i=[],h+=1;--h;)for(s=u-h,i[s]=[],p=l,p+=1;--p;){for(a=l-p,m=0,f=o,f+=1;--f;)r=o-f,m+=this.els[s][r]*n[r][a];i[s][a]=m}return n=new t(i),c?n.col(1):n},t.prototype.transpose=function(){var e,n,r,o,i,s,a;for(a=this.els.length,e=this.els[0].length,n=[],i=e,i+=1;--i;)for(r=e-i,n[r]=[],s=a,s+=1;--s;)o=a-s,n[r][o]=this.els[o][r];return new t(n)},t.prototype.toRightTriangular=function(){var t,e,n,r,o,i,s,a,u,l,f,h,p,c;for(t=this.dup(),a=this.els.length,o=a,i=this.els[0].length;--a;){if(n=o-a,0===t.els[n][n])for(r=f=p=n+1;o>=p?o>f:f>o;r=o>=p?++f:--f)if(0!==t.els[r][n]){for(e=[],u=i,u+=1;--u;)l=i-u,e.push(t.els[n][l]+t.els[r][l]);t.els[n]=e;break}if(0!==t.els[n][n])for(r=h=c=n+1;o>=c?o>h:h>o;r=o>=c?++h:--h){for(s=t.els[r][n]/t.els[n][n],e=[],u=i,u+=1;--u;)l=i-u,e.push(n>=l?0:t.els[r][l]-t.els[n][l]*s);t.els[r]=e}}return t},t.prototype.augment=function(e){var n,r,o,i,s,a,u,l,f;if(n=e.els||e,"undefined"==typeof n[0][0]&&(n=new t(n).els),r=this.dup(),o=r.els[0].length,l=r.els.length,a=l,u=n[0].length,l!==n.length)return null;for(l+=1;--l;)for(i=a-l,f=u,f+=1;--f;)s=u-f,r.els[i][o+s]=n[i][s];return r},t.prototype.inverse=function(){var e,n,r,o,i,s,a,u,l,f,h,p,c;for(f=this.els.length,a=f,e=this.augment(t.I(f)).toRightTriangular(),u=e.els[0].length,i=[],f+=1;--f;){for(o=f-1,r=[],h=u,i[o]=[],n=e.els[o][o],h+=1;--h;)p=u-h,l=e.els[o][p]/n,r.push(l),p>=a&&i[o].push(l);for(e.els[o]=r,s=c=0;o>=0?o>c:c>o;s=o>=0?++c:--c){for(r=[],h=u,h+=1;--h;)p=u-h,r.push(e.els[s][p]-e.els[o][p]*e.els[s][o]);e.els[s]=r}}return new t(i)},t.I=function(e){var n,r,o,i,s;for(n=[],i=e,e+=1;--e;)for(r=i-e,n[r]=[],s=i,s+=1;--s;)o=i-s,n[r][o]=r===o?1:0;return new t(n)},t.prototype.decompose=function(){var t,n,r,o,i,s,a,u,l,f,p,c,m,d,g,y,v,b,w,x,M,S,k,T,C,H,R,q,X,I,Y,j,z,F,G,A,O,V;for(s=this,x=[],v=[],b=[],f=[],u=[],t=[],n=X=0;3>=X;n=++X)for(t[n]=[],o=I=0;3>=I;o=++I)t[n][o]=s.els[n][o];if(0===t[3][3])return!1;for(n=Y=0;3>=Y;n=++Y)for(o=j=0;3>=j;o=++j)t[n][o]/=t[3][3];for(l=s.dup(),n=z=0;2>=z;n=++z)l.els[n][3]=0;if(l.els[3][3]=1,0!==t[0][3]||0!==t[1][3]||0!==t[2][3]){for(c=new h(t.slice(0,4)[3]),r=l.inverse(),M=r.transpose(),u=M.multiply(c).els,n=F=0;2>=F;n=++F)t[n][3]=0;t[3][3]=1}else u=[0,0,0,1];for(n=G=0;2>=G;n=++G)x[n]=t[3][n],t[3][n]=0;for(d=[],n=A=0;2>=A;n=++A)d[n]=new h(t[n].slice(0,3));if(v[0]=d[0].length(),d[0]=d[0].normalize(),b[0]=d[0].dot(d[1]),d[1]=d[1].combine(d[0],1,-b[0]),v[1]=d[1].length(),d[1]=d[1].normalize(),b[0]/=v[1],b[1]=d[0].dot(d[2]),d[2]=d[2].combine(d[0],1,-b[1]),b[2]=d[1].dot(d[2]),d[2]=d[2].combine(d[1],1,-b[2]),v[2]=d[2].length(),d[2]=d[2].normalize(),b[1]/=v[2],b[2]/=v[2],a=d[1].cross(d[2]),d[0].dot(a)<0)for(n=O=0;2>=O;n=++O)for(v[n]*=-1,o=V=0;2>=V;o=++V)d[n].els[o]*=-1;g=function(t,e){return d[t].els[e]},m=[],m[1]=Math.asin(-g(0,2)),0!==Math.cos(m[1])?(m[0]=Math.atan2(g(1,2),g(2,2)),m[2]=Math.atan2(g(0,1),g(0,0))):(m[0]=Math.atan2(-g(2,0),g(1,1)),m[1]=0),w=g(0,0)+g(1,1)+g(2,2)+1,w>1e-4?(y=.5/Math.sqrt(w),C=.25/y,H=(g(2,1)-g(1,2))*y,R=(g(0,2)-g(2,0))*y,q=(g(1,0)-g(0,1))*y):g(0,0)>g(1,1)&&g(0,0)>g(2,2)?(y=2*Math.sqrt(1+g(0,0)-g(1,1)-g(2,2)),H=.25*y,R=(g(0,1)+g(1,0))/y,q=(g(0,2)+g(2,0))/y,C=(g(2,1)-g(1,2))/y):g(1,1)>g(2,2)?(y=2*Math.sqrt(1+g(1,1)-g(0,0)-g(2,2)),H=(g(0,1)+g(1,0))/y,R=.25*y,q=(g(1,2)+g(2,1))/y,C=(g(0,2)-g(2,0))/y):(y=2*Math.sqrt(1+g(2,2)-g(0,0)-g(1,1)),H=(g(0,2)+g(2,0))/y,R=(g(1,2)+g(2,1))/y,q=.25*y,C=(g(1,0)-g(0,1))/y),f=[H,R,q,C],p=new e,p.translate=x,p.scale=v,p.skew=b,p.quaternion=f,p.perspective=u,p.rotate=m;for(k in p){S=p[k];for(i in S)T=S[i],isNaN(T)&&(S[i]=0)}return p},t.prototype.toString=function(){var t,e,n,r,o;for(n="matrix3d(",t=r=0;3>=r;t=++r)for(e=o=0;3>=o;e=++o)n+=Z(this.els[t][e],10),(3!==t||3!==e)&&(n+=",");return n+=")"},t.matrixForTransform=w(function(t){var e,n,r,o,i,s;return e=document.createElement("div"),e.style.position="absolute",e.style.visibility="hidden",e.style[A("transform")]=t,document.body.appendChild(e),r=window.getComputedStyle(e,null),n=null!=(o=null!=(i=r.transform)?i:r[A("transform")])?o:null!=(s=C.tests)?s.matrixForTransform(t):void 0,document.body.removeChild(e),n}),t.fromTransform=function(e){var n,r,o,i,s,a;for(i=null!=e?e.match(/matrix3?d?\(([-0-9,e \.]*)\)/):void 0,i?(n=i[1].split(","),n=n.map(parseFloat),r=6===n.length?[n[0],n[1],0,0,n[2],n[3],0,0,0,0,1,0,n[4],n[5],0,1]:n):r=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],s=[],o=a=0;3>=a;o=++a)s.push(r.slice(4*o,4*o+4));return new t(s)},t}(),G=w(function(t){var e,n,r,o,i,s,a,u,l,f;if(void 0!==document.body.style[t])return"";for(o=t.split("-"),i="",s=0,u=o.length;u>s;s++)r=o[s],i+=r.substring(0,1).toUpperCase()+r.substring(1);for(f=["Webkit","Moz","ms"],a=0,l=f.length;l>a;a++)if(n=f[a],e=n+i,void 0!==document.body.style[e])return n;return""}),A=w(function(t){var e;return e=G(t),"Moz"===e?""+e+(t.substring(0,1).toUpperCase()+t.substring(1)):""!==e?"-"+e.toLowerCase()+"-"+_(t):_(t)}),V="undefined"!=typeof window&&null!==window?window.requestAnimationFrame:void 0,m=[],d=[],W=!1,N=1,"undefined"!=typeof window&&null!==window&&window.addEventListener("keyup",function(t){return 68===t.keyCode&&t.shiftKey&&t.ctrlKey?C.toggleSlow():void 0}),null==V&&(I=0,V=function(t){var e,n,r;return e=Date.now(),r=Math.max(0,16-(e-I)),n=window.setTimeout(function(){return t(e+r)},r),I=e+r,n}),L=!1,E=!1,$=function(){return L?void 0:(L=!0,V(D))},D=function(t){var e,n,r,o;if(E)return void V(D);for(n=[],r=0,o=m.length;o>r;r++)e=m[r],c(t,e)||n.push(e);return m=m.filter(function(t){return-1===n.indexOf(t)}),0===m.length?L=!1:V(D)},c=function(t,e){var n,r,o,i,s,a,u,l;if(null==e.tStart&&(e.tStart=t),i=(t-e.tStart)/e.options.duration,s=e.curve(i),r={},i>=1)r=e.curve.returnsToSelf?e.properties.start:e.properties.end;else{l=e.properties.start;for(n in l)o=l[n],r[n]=R(o,e.properties.end[n],s)}return y(e.el,r),"function"==typeof(a=e.options).change&&a.change(e.el,Math.min(1,i)),i>=1&&"function"==typeof(u=e.options).complete&&u.complete(e.el),1>i},R=function(t,e,n){return null!=t&&null!=t.interpolate?t.interpolate(e,n):null},U=function(t,e,n,r){var o,s,f,h,p,c,g,y;if(null!=r&&(d=d.filter(function(t){return t.id!==r})),C.stop(t,{timeout:!1}),!n.animated)return C.css(t,e),void("function"==typeof n.complete&&n.complete(this));e=F(e),c=H(t,Object.keys(e)),o={},g=[];for(h in e)y=e[h],null!=t.style&&te.contains(h)?g.push([h,y]):(s=S(y),s instanceof i&&null!=t.style&&(s=new a([s,ne(h,0)])),o[h]=s);return g.length>0&&(f=X(t),f?(p=new l,p.applyProperties(g)):(y=g.map(function(t){return ee(t[0],t[1])}).join(" "),p=u.fromTransform(u.matrixForTransform(y))),o.transform=p.decompose(),f&&c.transform.applyRotateCenter([o.transform.props.rotate[1],o.transform.props.rotate[2]])),m.push({el:t,properties:{start:c,end:o},options:n,curve:n.type.call(n.type,n)}),$()},Q=[],J=0,P=function(t){return q()?t.realTimeoutId=setTimeout(function(){return t.fn(),x(t.id)},t.delay):void 0},p=function(t,e){var n;return J+=1,n={id:J,tStart:Date.now(),fn:t,delay:e,originalDelay:e},P(n),Q.push(n),J},x=function(t){return Q=Q.filter(function(e){return e.id===t&&clearTimeout(e.realTimeoutId),e.id!==t})},Y=function(t,e){var n;return null!=t?(n=t-e.tStart,e.originalDelay-n):e.originalDelay},"undefined"!=typeof window&&null!==window&&window.addEventListener("unload",function(){}),K=null,z(function(t){var e,n,r,o,i,s,a,u,l,f;if(E=!t,t){if(L)for(n=Date.now()-K,i=0,u=m.length;u>i;i++)e=m[i],null!=e.tStart&&(e.tStart+=n);for(s=0,l=Q.length;l>s;s++)r=Q[s],r.delay=Y(K,r),P(r);return K=null}for(K=Date.now(),f=[],o=0,a=Q.length;a>o;o++)r=Q[o],f.push(clearTimeout(r.realTimeoutId));return f}),C={},C.linear=function(){return function(t){return t}},C.spring=function(t){var e,n,r,o,i,s;return null==t&&(t={}),g(t,C.spring.defaults),o=Math.max(1,t.frequency/20),i=Math.pow(20,t.friction/100),s=t.anticipationSize/1e3,r=Math.max(0,s),e=function(e){var n,r,o,i,a;return n=.8,i=s/(1-s),a=0,o=(i-n*a)/(i-a),r=(n-o)/i,r*e*t.anticipationStrength/100+o},n=function(t){return Math.pow(i/10,-t)*(1-t)},function(t){var r,i,a,u,l,f,h,p;return f=t/(1-s)-s/(1-s),s>t?(p=s/(1-s)-s/(1-s),h=0/(1-s)-s/(1-s),l=Math.acos(1/e(p)),a=(Math.acos(1/e(h))-l)/(o*-s),r=e):(r=n,l=0,a=1),i=r(f),u=o*(t-s)*a+l,1-i*Math.cos(u)}},C.bounce=function(t){var e,n,r,o;return null==t&&(t={}),g(t,C.bounce.defaults),r=Math.max(1,t.frequency/20),o=Math.pow(20,t.friction/100),e=function(t){return Math.pow(o/10,-t)*(1-t)},n=function(t){var n,o,i,s;return s=-1.57,o=1,n=e(t),i=r*t*o+s,n*Math.cos(i)},n.returnsToSelf=!0,n},C.gravity=function(t){var e,n,r,o,i,s,a;return null==t&&(t={}),g(t,C.gravity.defaults),n=Math.min(t.bounciness/1250,.8),o=t.elasticity/1e3,a=100,r=[],e=function(){var r,o;for(r=Math.sqrt(2/a),o={a:-r,b:r,H:1},t.returnsToSelf&&(o.a=0,o.b=2*o.b);o.H>.001;)e=o.b-o.a,o={a:o.b,b:o.b+e*n,H:o.H*n*n};return o.b}(),s=function(n,r,o,i){var s,a;return e=r-n,a=2/e*i-1-2*n/e,s=a*a*o-o+1,t.returnsToSelf&&(s=1-s),s},function(){var i,s,u,l;for(s=Math.sqrt(2/(a*e*e)),u={a:-s,b:s,H:1},t.returnsToSelf&&(u.a=0,u.b=2*u.b),r.push(u),i=e,l=[];u.b<1&&u.H>.001;)i=u.b-u.a,u={a:u.b,b:u.b+i*n,H:u.H*o},l.push(r.push(u));return l}(),i=function(e){var n,o,i;for(o=0,n=r[o];!(e>=n.a&&e<=n.b)&&(o+=1,n=r[o]););return i=n?s(n.a,n.b,n.H,e):t.returnsToSelf?0:1},i.returnsToSelf=t.returnsToSelf,i},C.forceWithGravity=function(t){return null==t&&(t={}),g(t,C.forceWithGravity.defaults),t.returnsToSelf=!0,C.gravity(t)},C.bezier=function(){var t,e,n;return e=function(t,e,n,r,o){return Math.pow(1-t,3)*e+3*Math.pow(1-t,2)*t*n+3*(1-t)*Math.pow(t,2)*r+Math.pow(t,3)*o},t=function(t,n,r,o,i){return{x:e(t,n.x,r.x,o.x,i.x),y:e(t,n.y,r.y,o.y,i.y)}},n=function(t,e,n){var r,o,i,s,a,u,l,f,h,p;for(r=null,h=0,p=e.length;p>h&&(o=e[h],t>=o(0).x&&t<=o(1).x&&(r=o),null===r);h++);if(!r)return n?0:1;for(f=1e-4,s=0,u=1,a=(u+s)/2,l=r(a).x,i=0;Math.abs(t-l)>f&&100>i;)t>l?s=a:u=a,a=(u+s)/2,l=r(a).x,i+=1;return r(a).y},function(e){var r,o,i;return null==e&&(e={}),i=e.points,r=function(){var e,n,o;r=[],o=function(e,n){var o;return o=function(r){return t(r,e,e.cp[e.cp.length-1],n.cp[0],n)},r.push(o)};for(e in i){if(n=parseInt(e),n>=i.length-1)break;o(i[n],i[n+1])}return r}(),o=function(t){return 0===t?0:1===t?1:n(t,r,this.returnsToSelf)},o.returnsToSelf=0===i[i.length-1].y,o}}(),C.easeInOut=function(t){var e,n;return null==t&&(t={}),e=null!=(n=t.friction)?n:C.easeInOut.defaults.friction,C.bezier({points:[{x:0,y:0,cp:[{x:.92-e/1e3,y:0}]},{x:1,y:1,cp:[{x:.08+e/1e3,y:1}]}]})},C.easeIn=function(t){var e,n;return null==t&&(t={}),e=null!=(n=t.friction)?n:C.easeIn.defaults.friction,C.bezier({points:[{x:0,y:0,cp:[{x:.92-e/1e3,y:0}]},{x:1,y:1,cp:[{x:1,y:1}]}]})},C.easeOut=function(t){var e,n;return null==t&&(t={}),e=null!=(n=t.friction)?n:C.easeOut.defaults.friction,C.bezier({points:[{x:0,y:0,cp:[{x:0,y:0}]},{x:1,y:1,cp:[{x:.08+e/1e3,y:1}]}]})},C.spring.defaults={frequency:300,friction:200,anticipationSize:0,anticipationStrength:0},C.bounce.defaults={frequency:300,friction:200},C.forceWithGravity.defaults=C.gravity.defaults={bounciness:400,elasticity:200},C.easeInOut.defaults=C.easeIn.defaults=C.easeOut.defaults={friction:500},C.css=j(function(t,e){return v(t,e,!0)}),C.animate=j(function(t,e,n){var r;return null==n&&(n={}),n=M(n),g(n,{type:C.easeInOut,duration:1e3,delay:0,animated:!0}),n.duration=Math.max(0,n.duration*N),n.delay=Math.max(0,n.delay),0===n.delay?U(t,e,n):(r=C.setTimeout(function(){return U(t,e,n,r)},n.delay),d.push({id:r,el:t}))}),C.stop=j(function(t,e){return null==e&&(e={}),null==e.timeout&&(e.timeout=!0),e.timeout&&(d=d.filter(function(n){return n.el!==t||null!=e.filter&&!e.filter(n)?!0:(C.clearTimeout(n.id),!1)})),m=m.filter(function(e){return e.el!==t})}),C.setTimeout=function(t,e){return p(t,e*N)},C.clearTimeout=function(t){return x(t)},C.toggleSlow=function(){return W=!W,N=W?3:1,"undefined"!=typeof console&&null!==console&&"function"==typeof console.log?console.log("dynamics.js: slow animations "+(W?"enabled":"disabled")):void 0},"object"==typeof module&&"object"==typeof module.exports?module.exports=C:"function"==typeof define?define("dynamics",function(){return C}):window.dynamics=C}).call(this);

/*!
 * footer-reveal.js
 * 
 * Licensed under the MIT license.
 * http://www.opensource.org/licenses/mit-license.php
 * 
 * Copyright 2014 Iain Andrew
 * https://github.com/IainAndrew
 */
!function(a){a.fn.footerReveal=function(b){var c=a(this),d=c.prev(),e=a(window),f=a.extend({shadow:!0,shadowOpacity:.8,zIndex:-100},b);a.extend(!0,{},f,b);return c.outerHeight()<=e.outerHeight()&&(c.css({"z-index":f.zIndex,position:"fixed",bottom:0}),f.shadow&&d.css({"-moz-box-shadow":"0 20px 30px -20px rgba(0,0,0,"+f.shadowOpacity+")","-webkit-box-shadow":"0 20px 30px -20px rgba(0,0,0,"+f.shadowOpacity+")","box-shadow":"0 20px 30px -20px rgba(0,0,0,"+f.shadowOpacity+")"}),e.on("load resize",function(){c.css({width:d.outerWidth()}),d.css({"margin-bottom":c.outerHeight()})})),this}}(jQuery);

/*!
 * Justified Gallery
 */
!function(a){function b(){return a("body").height()>a(window).height()}var c=function(b,c){this.settings=c,this.checkSettings(),this.imgAnalyzerTimeout=null,this.entries=null,this.buildingRow={entriesBuff:[],width:0,height:0,aspectRatio:0},this.lastAnalyzedIndex=-1,this.yield={every:2,flushed:0},this.border=c.border>=0?c.border:c.margins,this.maxRowHeight=this.retrieveMaxRowHeight(),this.suffixRanges=this.retrieveSuffixRanges(),this.offY=this.border,this.spinner={phase:0,timeSlot:150,$el:a('<div class="spinner"><span></span><span></span><span></span></div>'),intervalId:null},this.checkWidthIntervalId=null,this.galleryWidth=b.width(),this.$gallery=b};c.prototype.getSuffix=function(a,b){var c,d;for(c=a>b?a:b,d=0;d<this.suffixRanges.length;d++)if(c<=this.suffixRanges[d])return this.settings.sizeRangeSuffixes[this.suffixRanges[d]];return this.settings.sizeRangeSuffixes[this.suffixRanges[d-1]]},c.prototype.removeSuffix=function(a,b){return a.substring(0,a.length-b.length)},c.prototype.endsWith=function(a,b){return-1!==a.indexOf(b,a.length-b.length)},c.prototype.getUsedSuffix=function(a){for(var b in this.settings.sizeRangeSuffixes)if(this.settings.sizeRangeSuffixes.hasOwnProperty(b)){if(0===this.settings.sizeRangeSuffixes[b].length)continue;if(this.endsWith(a,this.settings.sizeRangeSuffixes[b]))return this.settings.sizeRangeSuffixes[b]}return""},c.prototype.newSrc=function(a,b,c){var d;if(this.settings.thumbnailPath)d=this.settings.thumbnailPath(a,b,c);else{var e=a.match(this.settings.extension),f=null!==e?e[0]:"";d=a.replace(this.settings.extension,""),d=this.removeSuffix(d,this.getUsedSuffix(d)),d+=this.getSuffix(b,c)+f}return d},c.prototype.showImg=function(a,b){this.settings.cssAnimation?(a.addClass("entry-visible"),b&&b()):a.stop().fadeTo(this.settings.imagesAnimationDuration,1,b)},c.prototype.extractImgSrcFromImage=function(a){var b="undefined"!=typeof a.data("safe-src")?a.data("safe-src"):a.attr("src");return a.data("jg.originalSrc",b),b},c.prototype.imgFromEntry=function(a){var b=a.find("> img");return 0===b.length&&(b=a.find("> a > img")),0===b.length?null:b},c.prototype.captionFromEntry=function(a){var b=a.find("> .caption");return 0===b.length?null:b},c.prototype.displayEntry=function(b,c,d,e,f,g){b.width(e),b.height(g),b.css("top",d),b.css("left",c);var h=this.imgFromEntry(b);if(null!==h){h.css("width",e),h.css("height",f),h.css("margin-left",-e/2),h.css("margin-top",-f/2);var i=h.attr("src"),j=this.newSrc(i,e,f);h.one("error",function(){h.attr("src",h.data("jg.originalSrc"))});var k=function(){i!==j&&h.attr("src",j)};"skipped"===b.data("jg.loaded")?this.onImageEvent(i,a.proxy(function(){this.showImg(b,k),b.data("jg.loaded",!0)},this)):this.showImg(b,k)}else this.showImg(b);this.displayEntryCaption(b)},c.prototype.displayEntryCaption=function(b){var c=this.imgFromEntry(b);if(null!==c&&this.settings.captions){var d=this.captionFromEntry(b);if(null===d){var e=c.attr("alt");this.isValidCaption(e)||(e=b.attr("title")),this.isValidCaption(e)&&(d=a('<div class="caption">'+e+"</div>"),b.append(d),b.data("jg.createdCaption",!0))}null!==d&&(this.settings.cssAnimation||d.stop().fadeTo(0,this.settings.captionSettings.nonVisibleOpacity),this.addCaptionEventsHandlers(b))}else this.removeCaptionEventsHandlers(b)},c.prototype.isValidCaption=function(a){return"undefined"!=typeof a&&a.length>0},c.prototype.onEntryMouseEnterForCaption=function(b){var c=this.captionFromEntry(a(b.currentTarget));this.settings.cssAnimation?c.addClass("caption-visible").removeClass("caption-hidden"):c.stop().fadeTo(this.settings.captionSettings.animationDuration,this.settings.captionSettings.visibleOpacity)},c.prototype.onEntryMouseLeaveForCaption=function(b){var c=this.captionFromEntry(a(b.currentTarget));this.settings.cssAnimation?c.removeClass("caption-visible").removeClass("caption-hidden"):c.stop().fadeTo(this.settings.captionSettings.animationDuration,this.settings.captionSettings.nonVisibleOpacity)},c.prototype.addCaptionEventsHandlers=function(b){var c=b.data("jg.captionMouseEvents");"undefined"==typeof c&&(c={mouseenter:a.proxy(this.onEntryMouseEnterForCaption,this),mouseleave:a.proxy(this.onEntryMouseLeaveForCaption,this)},b.on("mouseenter",void 0,void 0,c.mouseenter),b.on("mouseleave",void 0,void 0,c.mouseleave),b.data("jg.captionMouseEvents",c))},c.prototype.removeCaptionEventsHandlers=function(a){var b=a.data("jg.captionMouseEvents");"undefined"!=typeof b&&(a.off("mouseenter",void 0,b.mouseenter),a.off("mouseleave",void 0,b.mouseleave),a.removeData("jg.captionMouseEvents"))},c.prototype.prepareBuildingRow=function(a){var b,c,d,e,f,g=!0,h=0,i=this.galleryWidth-2*this.border-(this.buildingRow.entriesBuff.length-1)*this.settings.margins,j=i/this.buildingRow.aspectRatio,k=this.buildingRow.width/i>this.settings.justifyThreshold;if(a&&"hide"===this.settings.lastRow&&!k){for(b=0;b<this.buildingRow.entriesBuff.length;b++)c=this.buildingRow.entriesBuff[b],this.settings.cssAnimation?c.removeClass("entry-visible"):c.stop().fadeTo(0,0);return-1}for(a&&!k&&"justify"!==this.settings.lastRow&&"hide"!==this.settings.lastRow&&(g=!1),b=0;b<this.buildingRow.entriesBuff.length;b++)c=this.buildingRow.entriesBuff[b],d=c.data("jg.width")/c.data("jg.height"),g?(e=b===this.buildingRow.entriesBuff.length-1?i:j*d,f=j):(e=this.settings.rowHeight*d,f=this.settings.rowHeight),i-=Math.round(e),c.data("jg.jwidth",Math.round(e)),c.data("jg.jheight",Math.ceil(f)),(0===b||h>f)&&(h=f);return this.settings.fixedHeight&&h>this.settings.rowHeight&&(h=this.settings.rowHeight),this.buildingRow.height=h,g},c.prototype.clearBuildingRow=function(){this.buildingRow.entriesBuff=[],this.buildingRow.aspectRatio=0,this.buildingRow.width=0},c.prototype.flushRow=function(a){var b,c,d,e=this.settings,f=this.border;if(c=this.prepareBuildingRow(a),a&&"hide"===e.lastRow&&-1===this.buildingRow.height)return void this.clearBuildingRow();if(this.maxRowHeight.isPercentage?this.maxRowHeight.value*e.rowHeight<this.buildingRow.height&&(this.buildingRow.height=this.maxRowHeight.value*e.rowHeight):this.maxRowHeight.value>0&&this.maxRowHeight.value<this.buildingRow.height&&(this.buildingRow.height=this.maxRowHeight.value),"center"===e.lastRow||"right"===e.lastRow){var g=this.galleryWidth-2*this.border-(this.buildingRow.entriesBuff.length-1)*e.margins;for(d=0;d<this.buildingRow.entriesBuff.length;d++)b=this.buildingRow.entriesBuff[d],g-=b.data("jg.jwidth");"center"===e.lastRow?f+=g/2:"right"===e.lastRow&&(f+=g)}for(d=0;d<this.buildingRow.entriesBuff.length;d++)b=this.buildingRow.entriesBuff[d],this.displayEntry(b,f,this.offY,b.data("jg.jwidth"),b.data("jg.jheight"),this.buildingRow.height),f+=b.data("jg.jwidth")+e.margins;this.galleryHeightToSet=this.offY+this.buildingRow.height+this.border+(this.isSpinnerActive()?this.getSpinnerHeight():0),(!a||this.buildingRow.height<=e.rowHeight&&c)&&(this.offY+=this.buildingRow.height+e.margins,this.clearBuildingRow(),this.$gallery.trigger("jg.rowflush"))};var d=!1;c.prototype.checkWidth=function(){this.checkWidthIntervalId=setInterval(a.proxy(function(){var a=parseFloat(this.$gallery.width());b()===d?Math.abs(a-this.galleryWidth)>this.settings.refreshSensitivity&&(this.galleryWidth=a,this.rewind(),this.startImgAnalyzer(!0)):(d=b(),this.galleryWidth=a)},this),this.settings.refreshTime)},c.prototype.isSpinnerActive=function(){return null!==this.spinner.intervalId},c.prototype.getSpinnerHeight=function(){return this.spinner.$el.innerHeight()},c.prototype.stopLoadingSpinnerAnimation=function(){clearInterval(this.spinner.intervalId),this.spinner.intervalId=null,this.$gallery.height(this.$gallery.height()-this.getSpinnerHeight()),this.spinner.$el.detach()},c.prototype.startLoadingSpinnerAnimation=function(){var a=this.spinner,b=a.$el.find("span");clearInterval(a.intervalId),this.$gallery.append(a.$el),this.$gallery.height(this.offY+this.buildingRow.height+this.getSpinnerHeight()),a.intervalId=setInterval(function(){a.phase<b.length?b.eq(a.phase).fadeTo(a.timeSlot,1):b.eq(a.phase-b.length).fadeTo(a.timeSlot,0),a.phase=(a.phase+1)%(2*b.length)},a.timeSlot)},c.prototype.rewind=function(){this.lastAnalyzedIndex=-1,this.offY=this.border,this.clearBuildingRow()},c.prototype.updateEntries=function(b){return this.entries=this.$gallery.find(this.settings.selector).toArray(),0===this.entries.length?!1:(this.settings.filter?this.modifyEntries(this.filterArray,b):this.modifyEntries(this.resetFilters,b),a.isFunction(this.settings.sort)?this.modifyEntries(this.sortArray,b):this.settings.randomize&&this.modifyEntries(this.shuffleArray,b),!0)},c.prototype.insertToGallery=function(b){var c=this;a.each(b,function(){a(this).appendTo(c.$gallery)})},c.prototype.shuffleArray=function(a){var b,c,d;for(b=a.length-1;b>0;b--)c=Math.floor(Math.random()*(b+1)),d=a[b],a[b]=a[c],a[c]=d;return this.insertToGallery(a),a},c.prototype.sortArray=function(a){return a.sort(this.settings.sort),this.insertToGallery(a),a},c.prototype.resetFilters=function(b){for(var c=0;c<b.length;c++)a(b[c]).removeClass("jg-filtered");return b},c.prototype.filterArray=function(b){var c=this.settings;return"string"===a.type(c.filter)?b.filter(function(b){var d=a(b);return d.is(c.filter)?(d.removeClass("jg-filtered"),!0):(d.addClass("jg-filtered"),!1)}):a.isFunction(c.filter)?b.filter(c.filter):void 0},c.prototype.modifyEntries=function(a,b){var c=b?this.entries.splice(this.lastAnalyzedIndex+1,this.entries.length-this.lastAnalyzedIndex-1):this.entries;c=a.call(this,c),this.entries=b?this.entries.concat(c):c},c.prototype.destroy=function(){clearInterval(this.checkWidthIntervalId),a.each(this.entries,a.proxy(function(b,c){var d=a(c);d.css("width",""),d.css("height",""),d.css("top",""),d.css("left",""),d.data("jg.loaded",void 0),d.removeClass("jg-entry");var e=this.imgFromEntry(d);e.css("width",""),e.css("height",""),e.css("margin-left",""),e.css("margin-top",""),e.attr("src",e.data("jg.originalSrc")),e.data("jg.originalSrc",void 0),this.removeCaptionEventsHandlers(d);var f=this.captionFromEntry(d);d.data("jg.createdCaption")?(d.data("jg.createdCaption",void 0),null!==f&&f.remove()):null!==f&&f.fadeTo(0,1)},this)),this.$gallery.css("height",""),this.$gallery.removeClass("justified-gallery"),this.$gallery.data("jg.controller",void 0)},c.prototype.analyzeImages=function(b){for(var c=this.lastAnalyzedIndex+1;c<this.entries.length;c++){var d=a(this.entries[c]);if(d.data("jg.loaded")===!0||"skipped"===d.data("jg.loaded")){var e=this.galleryWidth-2*this.border-(this.buildingRow.entriesBuff.length-1)*this.settings.margins,f=d.data("jg.width")/d.data("jg.height");if(e/(this.buildingRow.aspectRatio+f)<this.settings.rowHeight&&(this.flushRow(!1),++this.yield.flushed>=this.yield.every))return void this.startImgAnalyzer(b);this.buildingRow.entriesBuff.push(d),this.buildingRow.aspectRatio+=f,this.buildingRow.width+=f*this.settings.rowHeight,this.lastAnalyzedIndex=c}else if("error"!==d.data("jg.loaded"))return}this.buildingRow.entriesBuff.length>0&&this.flushRow(!0),this.isSpinnerActive()&&this.stopLoadingSpinnerAnimation(),this.stopImgAnalyzerStarter(),this.$gallery.trigger(b?"jg.resize":"jg.complete"),this.$gallery.height(this.galleryHeightToSet)},c.prototype.stopImgAnalyzerStarter=function(){this.yield.flushed=0,null!==this.imgAnalyzerTimeout&&clearTimeout(this.imgAnalyzerTimeout)},c.prototype.startImgAnalyzer=function(a){var b=this;this.stopImgAnalyzerStarter(),this.imgAnalyzerTimeout=setTimeout(function(){b.analyzeImages(a)},.001)},c.prototype.onImageEvent=function(b,c,d){if(c||d){var e=new Image,f=a(e);c&&f.one("load",function(){f.off("load error"),c(e)}),d&&f.one("error",function(){f.off("load error"),d(e)}),e.src=b}},c.prototype.init=function(){var b=!1,c=!1,d=this;a.each(this.entries,function(e,f){var g=a(f),h=d.imgFromEntry(g);if(g.addClass("jg-entry"),g.data("jg.loaded")!==!0&&"skipped"!==g.data("jg.loaded"))if(null!==d.settings.rel&&g.attr("rel",d.settings.rel),null!==d.settings.target&&g.attr("target",d.settings.target),null!==h){var i=d.extractImgSrcFromImage(h);if(h.attr("src",i),d.settings.waitThumbnailsLoad===!1){var j=parseFloat(h.attr("width")),k=parseFloat(h.attr("height"));if(!isNaN(j)&&!isNaN(k))return g.data("jg.width",j),g.data("jg.height",k),g.data("jg.loaded","skipped"),c=!0,d.startImgAnalyzer(!1),!0}g.data("jg.loaded",!1),b=!0,d.isSpinnerActive()||d.startLoadingSpinnerAnimation(),d.onImageEvent(i,function(a){g.data("jg.width",a.width),g.data("jg.height",a.height),g.data("jg.loaded",!0),d.startImgAnalyzer(!1)},function(){g.data("jg.loaded","error"),d.startImgAnalyzer(!1)})}else g.data("jg.loaded",!0),g.data("jg.width",g.width()|parseFloat(g.css("width"))|1),g.data("jg.height",g.height()|parseFloat(g.css("height"))|1)}),b||c||this.startImgAnalyzer(!1),this.checkWidth()},c.prototype.checkOrConvertNumber=function(b,c){if("string"===a.type(b[c])&&(b[c]=parseFloat(b[c])),"number"!==a.type(b[c]))throw c+" must be a number";if(isNaN(b[c]))throw"invalid number for "+c},c.prototype.checkSizeRangesSuffixes=function(){if("object"!==a.type(this.settings.sizeRangeSuffixes))throw"sizeRangeSuffixes must be defined and must be an object";var b=[];for(var c in this.settings.sizeRangeSuffixes)this.settings.sizeRangeSuffixes.hasOwnProperty(c)&&b.push(c);for(var d={0:""},e=0;e<b.length;e++)if("string"===a.type(b[e]))try{var f=parseInt(b[e].replace(/^[a-z]+/,""),10);d[f]=this.settings.sizeRangeSuffixes[b[e]]}catch(g){throw"sizeRangeSuffixes keys must contains correct numbers ("+g+")"}else d[b[e]]=this.settings.sizeRangeSuffixes[b[e]];this.settings.sizeRangeSuffixes=d},c.prototype.retrieveMaxRowHeight=function(){var b={};if("string"===a.type(this.settings.maxRowHeight))this.settings.maxRowHeight.match(/^[0-9]+%$/)?(b.value=parseFloat(this.settings.maxRowHeight.match(/^([0-9]+)%$/)[1])/100,b.isPercentage=!1):(b.value=parseFloat(this.settings.maxRowHeight),b.isPercentage=!0);else{if("number"!==a.type(this.settings.maxRowHeight))throw"maxRowHeight must be a number or a percentage";b.value=this.settings.maxRowHeight,b.isPercentage=!1}if(isNaN(b.value))throw"invalid number for maxRowHeight";return b.isPercentage?b.value<100&&(b.value=100):b.value>0&&b.value<this.settings.rowHeight&&(b.value=this.settings.rowHeight),b},c.prototype.checkSettings=function(){if(this.checkSizeRangesSuffixes(),this.checkOrConvertNumber(this.settings,"rowHeight"),this.checkOrConvertNumber(this.settings,"margins"),this.checkOrConvertNumber(this.settings,"border"),"justify"!==this.settings.lastRow&&"nojustify"!==this.settings.lastRow&&"left"!==this.settings.lastRow&&"center"!==this.settings.lastRow&&"right"!==this.settings.lastRow&&"hide"!==this.settings.lastRow)throw'lastRow must be "justify", "nojustify", "left", "center", "right" or "hide"';if(this.checkOrConvertNumber(this.settings,"justifyThreshold"),this.settings.justifyThreshold<0||this.settings.justifyThreshold>1)throw"justifyThreshold must be in the interval [0,1]";if("boolean"!==a.type(this.settings.cssAnimation))throw"cssAnimation must be a boolean";if("boolean"!==a.type(this.settings.captions))throw"captions must be a boolean";if(this.checkOrConvertNumber(this.settings.captionSettings,"animationDuration"),this.checkOrConvertNumber(this.settings.captionSettings,"visibleOpacity"),this.settings.captionSettings.visibleOpacity<0||this.settings.captionSettings.visibleOpacity>1)throw"captionSettings.visibleOpacity must be in the interval [0, 1]";if(this.checkOrConvertNumber(this.settings.captionSettings,"nonVisibleOpacity"),this.settings.captionSettings.nonVisibleOpacity<0||this.settings.captionSettings.nonVisibleOpacity>1)throw"captionSettings.nonVisibleOpacity must be in the interval [0, 1]";if("boolean"!==a.type(this.settings.fixedHeight))throw"fixedHeight must be a boolean";if(this.checkOrConvertNumber(this.settings,"imagesAnimationDuration"),this.checkOrConvertNumber(this.settings,"refreshTime"),this.checkOrConvertNumber(this.settings,"refreshSensitivity"),"boolean"!==a.type(this.settings.randomize))throw"randomize must be a boolean";if("string"!==a.type(this.settings.selector))throw"selector must be a string";if(this.settings.sort!==!1&&!a.isFunction(this.settings.sort))throw"sort must be false or a comparison function";if(this.settings.filter!==!1&&!a.isFunction(this.settings.filter)&&"string"!==a.type(this.settings.filter))throw"filter must be false, a string or a filter function"},c.prototype.retrieveSuffixRanges=function(){var a=[];for(var b in this.settings.sizeRangeSuffixes)this.settings.sizeRangeSuffixes.hasOwnProperty(b)&&a.push(parseInt(b,10));return a.sort(function(a,b){return a>b?1:b>a?-1:0}),a},c.prototype.updateSettings=function(b){this.settings=a.extend({},this.settings,b),this.checkSettings(),this.border=this.settings.border>=0?this.settings.border:this.settings.margins,this.maxRowHeight=this.retrieveMaxRowHeight(),this.suffixRanges=this.retrieveSuffixRanges()},a.fn.justifiedGallery=function(b){return this.each(function(d,e){var f=a(e);f.addClass("justified-gallery");var g=f.data("jg.controller");if("undefined"==typeof g){if("undefined"!=typeof b&&null!==b&&"object"!==a.type(b)){if("destroy"===b)return;throw"The argument must be an object"}g=new c(f,a.extend({},a.fn.justifiedGallery.defaults,b)),f.data("jg.controller",g)}else if("norewind"===b);else{if("destroy"===b)return void g.destroy();g.updateSettings(b),g.rewind()}g.updateEntries("norewind"===b)&&g.init()})},a.fn.justifiedGallery.defaults={sizeRangeSuffixes:{},thumbnailPath:void 0,rowHeight:120,maxRowHeight:-1,margins:1,border:-1,lastRow:"nojustify",justifyThreshold:.75,fixedHeight:!1,waitThumbnailsLoad:!0,captions:!0,cssAnimation:!1,imagesAnimationDuration:500,captionSettings:{animationDuration:500,visibleOpacity:.7,nonVisibleOpacity:0},rel:null,target:null,extension:/\.[^.\\/]+$/,refreshTime:200,refreshSensitivity:0,randomize:!1,sort:!1,filter:!1,selector:"> a, > div:not(.spinner)"}}(jQuery);

/**
* jQuery gMap - Google Maps API V3
*
* @url http://github.com/marioestrada/jQuery-gMap
* @author Mario Estrada <me@mario.ec> based on original plugin by Cedric Kastner <cedric@nur-text.de
* @version 2.1.2
*/
(function(a){a.fn.gMap=function(b,c){switch(b){case"addMarker":return a(this).trigger("gMap.addMarker",[c.latitude,c.longitude,c.content,c.icon,c.popup]);case"centerAt":return a(this).trigger("gMap.centerAt",[c.latitude,c.longitude,c.zoom])}var d=a.extend({},a.fn.gMap.defaults,b);return this.each(function(){var b=new google.maps.Map(this),c=new google.maps.Geocoder;d.address?c.geocode({address:d.address},function(a,c){a&&a.length&&b.setCenter(a[0].geometry.location)}):d.latitude&&d.longitude?b.setCenter(new google.maps.LatLng(d.latitude,d.longitude)):a.isArray(d.markers)&&d.markers.length>0?d.markers[0].address?c.geocode({address:d.markers[0].address},function(a,c){a&&a.length>0&&b.setCenter(a[0].geometry.location)}):b.setCenter(new google.maps.LatLng(d.markers[0].latitude,d.markers[0].longitude)):b.setCenter(new google.maps.LatLng(34.885931,9.84375)),b.setZoom(d.zoom),b.setMapTypeId(google.maps.MapTypeId[d.maptype]);var e={scrollwheel:d.scrollwheel,disableDoubleClickZoom:!d.doubleclickzoom};d.controls===!1?a.extend(e,{disableDefaultUI:!0}):d.controls.length!=0&&a.extend(e,d.controls,{disableDefaultUI:!0}),b.setOptions(e);var f=new google.maps.Marker;marker_icon=new google.maps.MarkerImage(d.icon.image),marker_icon.size=new google.maps.Size(d.icon.iconsize[0],d.icon.iconsize[1]),marker_icon.anchor=new google.maps.Point(d.icon.iconanchor[0],d.icon.iconanchor[1]),f.setIcon(marker_icon),d.icon.shadow&&(marker_shadow=new google.maps.MarkerImage(d.icon.shadow),marker_shadow.size=new google.maps.Size(d.icon.shadowsize[0],d.icon.shadowsize[1]),marker_shadow.anchor=new google.maps.Point(d.icon.shadowanchor[0],d.icon.shadowanchor[1]),f.setShadow(marker_shadow)),a(this).bind("gMap.centerAt",function(a,c,d,e){e&&b.setZoom(e),b.panTo(new google.maps.LatLng(parseFloat(c),parseFloat(d)))});var g;a(this).bind("gMap.addMarker",function(a,c,e,h,i,j){var k=new google.maps.LatLng(parseFloat(c),parseFloat(e)),l=new google.maps.Marker({position:k});i?(marker_icon=new google.maps.MarkerImage(i.image),marker_icon.size=new google.maps.Size(i.iconsize[0],i.iconsize[1]),marker_icon.anchor=new google.maps.Point(i.iconanchor[0],i.iconanchor[1]),l.setIcon(marker_icon),i.shadow&&(marker_shadow=new google.maps.MarkerImage(i.shadow),marker_shadow.size=new google.maps.Size(i.shadowsize[0],i.shadowsize[1]),marker_shadow.anchor=new google.maps.Point(i.shadowanchor[0],i.shadowanchor[1]),f.setShadow(marker_shadow))):(l.setIcon(f.getIcon()),l.setShadow(f.getShadow()));if(h){h=="_latlng"&&(h=c+", "+e);var m=new google.maps.InfoWindow({content:d.html_prepend+h+d.html_append});google.maps.event.addListener(l,"click",function(){g&&g.close(),m.open(b,l),g=m}),j&&google.maps.event.addListenerOnce(b,"tilesloaded",function(){m.open(b,l)})}l.setMap(b)});for(var h=0;h<d.markers.length;h++){marker=d.markers[h];if(marker.address){marker.html=="_address"&&(marker.html=marker.address);var i=this;c.geocode({address:marker.address},function(b,c){return function(d,e){d&&d.length>0&&a(c).trigger("gMap.addMarker",[d[0].geometry.location.lat(),d[0].geometry.location.lng(),b.html,b.icon,b.popup])}}(marker,i))}else a(this).trigger("gMap.addMarker",[marker.latitude,marker.longitude,marker.html,marker.icon,marker.popup])}})},a.fn.gMap.defaults={address:"",latitude:0,longitude:0,zoom:1,markers:[],controls:[],scrollwheel:!1,doubleclickzoom:!0,maptype:"ROADMAP",html_prepend:'<div class="gmap_marker">',html_append:"</div>",icon:{image:"http://www.google.com/mapfiles/marker.png",shadow:"http://www.google.com/mapfiles/shadow50.png",iconsize:[20,34],shadowsize:[37,34],iconanchor:[9,34],shadowanchor:[6,34]}}})(jQuery)

/*!
 * imagesLoaded PACKAGED v4.1.0
 * JavaScript is all like "You images are done yet or what?"
 * MIT License
 */
!function(t,e){"function"==typeof define&&define.amd?define("ev-emitter/ev-emitter",e):"object"==typeof module&&module.exports?module.exports=e():t.EvEmitter=e()}(this,function(){function t(){}var e=t.prototype;return e.on=function(t,e){if(t&&e){var i=this._events=this._events||{},n=i[t]=i[t]||[];return-1==n.indexOf(e)&&n.push(e),this}},e.once=function(t,e){if(t&&e){this.on(t,e);var i=this._onceEvents=this._onceEvents||{},n=i[t]=i[t]||[];return n[e]=!0,this}},e.off=function(t,e){var i=this._events&&this._events[t];if(i&&i.length){var n=i.indexOf(e);return-1!=n&&i.splice(n,1),this}},e.emitEvent=function(t,e){var i=this._events&&this._events[t];if(i&&i.length){var n=0,o=i[n];e=e||[];for(var r=this._onceEvents&&this._onceEvents[t];o;){var s=r&&r[o];s&&(this.off(t,o),delete r[o]),o.apply(this,e),n+=s?0:1,o=i[n]}return this}},t}),function(t,e){"use strict";"function"==typeof define&&define.amd?define(["ev-emitter/ev-emitter"],function(i){return e(t,i)}):"object"==typeof module&&module.exports?module.exports=e(t,require("ev-emitter")):t.imagesLoaded=e(t,t.EvEmitter)}(window,function(t,e){function i(t,e){for(var i in e)t[i]=e[i];return t}function n(t){var e=[];if(Array.isArray(t))e=t;else if("number"==typeof t.length)for(var i=0;i<t.length;i++)e.push(t[i]);else e.push(t);return e}function o(t,e,r){return this instanceof o?("string"==typeof t&&(t=document.querySelectorAll(t)),this.elements=n(t),this.options=i({},this.options),"function"==typeof e?r=e:i(this.options,e),r&&this.on("always",r),this.getImages(),h&&(this.jqDeferred=new h.Deferred),void setTimeout(function(){this.check()}.bind(this))):new o(t,e,r)}function r(t){this.img=t}function s(t,e){this.url=t,this.element=e,this.img=new Image}var h=t.jQuery,a=t.console;o.prototype=Object.create(e.prototype),o.prototype.options={},o.prototype.getImages=function(){this.images=[],this.elements.forEach(this.addElementImages,this)},o.prototype.addElementImages=function(t){"IMG"==t.nodeName&&this.addImage(t),this.options.background===!0&&this.addElementBackgroundImages(t);var e=t.nodeType;if(e&&d[e]){for(var i=t.querySelectorAll("img"),n=0;n<i.length;n++){var o=i[n];this.addImage(o)}if("string"==typeof this.options.background){var r=t.querySelectorAll(this.options.background);for(n=0;n<r.length;n++){var s=r[n];this.addElementBackgroundImages(s)}}}};var d={1:!0,9:!0,11:!0};return o.prototype.addElementBackgroundImages=function(t){var e=getComputedStyle(t);if(e)for(var i=/url\((['"])?(.*?)\1\)/gi,n=i.exec(e.backgroundImage);null!==n;){var o=n&&n[2];o&&this.addBackground(o,t),n=i.exec(e.backgroundImage)}},o.prototype.addImage=function(t){var e=new r(t);this.images.push(e)},o.prototype.addBackground=function(t,e){var i=new s(t,e);this.images.push(i)},o.prototype.check=function(){function t(t,i,n){setTimeout(function(){e.progress(t,i,n)})}var e=this;return this.progressedCount=0,this.hasAnyBroken=!1,this.images.length?void this.images.forEach(function(e){e.once("progress",t),e.check()}):void this.complete()},o.prototype.progress=function(t,e,i){this.progressedCount++,this.hasAnyBroken=this.hasAnyBroken||!t.isLoaded,this.emitEvent("progress",[this,t,e]),this.jqDeferred&&this.jqDeferred.notify&&this.jqDeferred.notify(this,t),this.progressedCount==this.images.length&&this.complete(),this.options.debug&&a&&a.log("progress: "+i,t,e)},o.prototype.complete=function(){var t=this.hasAnyBroken?"fail":"done";if(this.isComplete=!0,this.emitEvent(t,[this]),this.emitEvent("always",[this]),this.jqDeferred){var e=this.hasAnyBroken?"reject":"resolve";this.jqDeferred[e](this)}},r.prototype=Object.create(e.prototype),r.prototype.check=function(){var t=this.getIsImageComplete();return t?void this.confirm(0!==this.img.naturalWidth,"naturalWidth"):(this.proxyImage=new Image,this.proxyImage.addEventListener("load",this),this.proxyImage.addEventListener("error",this),this.img.addEventListener("load",this),this.img.addEventListener("error",this),void(this.proxyImage.src=this.img.src))},r.prototype.getIsImageComplete=function(){return this.img.complete&&void 0!==this.img.naturalWidth},r.prototype.confirm=function(t,e){this.isLoaded=t,this.emitEvent("progress",[this,this.img,e])},r.prototype.handleEvent=function(t){var e="on"+t.type;this[e]&&this[e](t)},r.prototype.onload=function(){this.confirm(!0,"onload"),this.unbindEvents()},r.prototype.onerror=function(){this.confirm(!1,"onerror"),this.unbindEvents()},r.prototype.unbindEvents=function(){this.proxyImage.removeEventListener("load",this),this.proxyImage.removeEventListener("error",this),this.img.removeEventListener("load",this),this.img.removeEventListener("error",this)},s.prototype=Object.create(r.prototype),s.prototype.check=function(){this.img.addEventListener("load",this),this.img.addEventListener("error",this),this.img.src=this.url;var t=this.getIsImageComplete();t&&(this.confirm(0!==this.img.naturalWidth,"naturalWidth"),this.unbindEvents())},s.prototype.unbindEvents=function(){this.img.removeEventListener("load",this),this.img.removeEventListener("error",this)},s.prototype.confirm=function(t,e){this.isLoaded=t,this.emitEvent("progress",[this,this.element,e])},o.makeJQueryPlugin=function(e){e=e||t.jQuery,e&&(h=e,h.fn.imagesLoaded=function(t,e){var i=new o(this,t,e);return i.jqDeferred.promise(h(this))})},o.makeJQueryPlugin(),o});


/*!
* main
*/
!function(a){"use strict";function b(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c]);return a}function c(a){var b=0;for(var c in a)a.hasOwnProperty(c)&&b++;return b}function d(a,b,c){var d;return function(){var e=this,f=arguments,g=function(){d=null,c||a.apply(e,f)},h=c&&!d;clearTimeout(d),d=setTimeout(g,b),h&&a.apply(e,f)}}function e(a,b,c,d,e,f){var g,h,i,j,k,l,m,n,o;if(h=d-a,i=e-b,j=Math.sqrt(i*i+h*h),j>c+f)return!1;if(j<Math.abs(c-f))return!1;g=(c*c-f*f+j*j)/(2*j),n=a+h*g/j,o=b+i*g/j,k=Math.sqrt(c*c-g*g),l=-i*(k/j),m=h*(k/j);var p=n+l,r=o+m;return{x:p,y:r}}function g(a,c){this.el=a,this.audioCtx=new AudioContext,this.options=b({},this.options),b(this.options,c),this.noiseVal=this.options.noiseGain,this.bufferDelay=2,this.armRotation=0,this.speakers=this.audioCtx.destination,this.effect=-1,this.convolver=this.audioCtx.createConvolver(),this.ui={player:this.el.querySelector(".player__element--lp"),recordCover:this.el.querySelector(".player__svg-lp > path#cover"),arm:this.el.querySelector(".player__element--tonearm > svg"),visualizer:this.el.querySelector(".player-stand > .visualizer")},this.ctrls={back:this.el.querySelector(".control-button--back"),play:this.el.querySelector(".player__controls > button.player-button--playstop"),playStatus:this.el.querySelector(".player__controls > button.player-button--playstop .icon--play"),stopStatus:this.el.querySelector(".player__controls > button.player-button--playstop .icon--stop"),rotate:this.el.querySelector(".player__controls > button.player-button--rotate"),vinylFx:this.el.querySelector(".effects > button.effects__button--vinyleffect"),roomFx:[].slice.call(this.el.querySelectorAll(".effects > .effects__irs > .effects__button"))},this.infoElems={artist:this.el.querySelector(".player-info > .artist--player"),title:this.el.querySelector(".player-info > .title--player"),year:this.el.querySelector(".player-info > .year--player"),song:this.el.querySelector(".player-stand > .song")};var d=this.ui.arm.getBoundingClientRect();this.armCenterPoint={x:d.left+d.width/2,y:d.top+d.height/2},this.cartridgeMargin=8,this.angleInterval={min:this._getAngle(this.ui.player),max:this._getAngle(this.ui.recordCover)},this._createAnalyser(),this._initEvents()}function h(a){this.wrapper=a,this.cover=this.wrapper.querySelector(".img-wrap--single"),this.position=this.wrapper.querySelector(".number"),this.artist=this.wrapper.querySelector(".artist"),this.title=this.wrapper.querySelector(".title"),this.year=this.wrapper.querySelector(".year"),this.info={coverImg:this.cover.querySelector("img").src,artist:this.artist.innerHTML,title:this.title.innerHTML,year:this.year.innerHTML,sides:{side1:this.wrapper.getAttribute("data-side1")?this.wrapper.getAttribute("data-side1").split(","):[],side2:this.wrapper.getAttribute("data-side2")?this.wrapper.getAttribute("data-side2").split(","):[]}}}function i(a,c){this.el=a,this.options=b({},this.options),b(this.options,c),this.records=[];var d=this;[].slice.call(this.el.querySelectorAll(".single")).forEach(function(a){var b=new h(a);d.records.push(b)}),this.recordsTotal=this.records.length,this.current=0,this.ctrls={next:this.el.querySelector(".controls__navigate > button.control-button--next"),prev:this.el.querySelector(".controls__navigate > button.control-button--prev"),play:this.el.querySelector("button.control-button--play"),back:this.el.querySelector("button.control-button--back")},this.lpPlayCtrlPath=this.ctrls.play.querySelector("svg.icon--progress > path"),this.lpPlayCtrlPathLen=this.lpPlayCtrlPath.getTotalLength(),dynamics.css(this.lpPlayCtrlPath,{strokeDasharray:this.lpPlayCtrlPathLen,strokeDashoffset:this.lpPlayCtrlPathLen}),this._initEvents()}function q(){var a=function(){classie.add(k,"grid--loaded"),w(),o=new i(document.querySelector(".view--single"),{onStop:function(){v("single","grid"),y()},onLoadRecord:function(a,b,c){p.loadRecord(a.info,function(){p.setRecordInfo(a.info),setTimeout(function(){o._showRecord()},50)},function(a){o.isLoading&&dynamics.animate(b,{strokeDashoffset:c*(1-a/100)},{duration:100,type:dynamics.linear})})},onShowRecord:function(a){dynamics.css(n,{opacity:1}),n.querySelector("image").setAttribute("xlink:href",a.info.coverImg),v("single","player"),setTimeout(function(){p.start()},600)}})};r(a)}function r(a){var b=0,c=function(){++b,2===b&&"function"==typeof a&&a()};s(c),t(function(a){u(a),c()})}function s(a){imagesLoaded(j.grid,function(){new Masonry(".grid",{itemSelector:".grid__item"}),"function"==typeof a&&a()})}function t(a){new AbbeyLoad([{room1:"mp3/room1.mp3",room2:"mp3/room2.mp3",room3:"mp3/room3.mp3",noise:"mp3/noise1.mp3"}],function(b){"function"==typeof a&&a(b)})}function u(a){p=new g(j.player,{noiseBuffer:a.noise,effectBuffers:[a.room1,a.room2,a.room3],onGoBack:function(){v("player","single"),o.restart(function(){dynamics.css(n,{opacity:0})})}})}function v(a,b){classie.remove(j[a],"view--current"),classie.add(j[b],"view--current")}function w(){l.forEach(function(a,b){a.addEventListener("click",function(a){a.preventDefault(),x({x:a.pageX,y:a.pageY},function(){v("grid","single")}),setTimeout(function(){o.start(b)},80)})});var b=d(function(b){f={width:a.innerWidth,height:a.innerHeight}},10);a.addEventListener("resize",b)}function x(a,b){dynamics.css(m,{opacity:1,left:a.x,top:a.y,backgroundColor:"#000000",scale:0}),dynamics.animate(m,{scale:1.5,backgroundColor:"#666666"},{duration:500,type:dynamics.easeOut,complete:function(){"function"==typeof b&&b()}})}function y(){dynamics.css(m,{left:a.innerWidth/2,top:a.innerHeight/2}),dynamics.animate(m,{opacity:0},{duration:500,type:dynamics.easeOut})}var f={width:a.innerWidth,height:a.innerHeight};g.prototype.options={noiseBuffer:"",noiseGain:.5,effectBuffers:[],onGoBack:function(){return!1}},g.prototype._loadAssets=function(a,b,c){new AbbeyLoad(a,function(a){b(a)},c)},g.prototype.loadRecord=function(a,b,d){var e=this;this.recordData={artist:a.artist,title:a.title,side1:{totalDuration:0,totalBuffers:0,bufferList:[],bufferNames:[]},side2:{totalDuration:0,totalBuffers:0,bufferList:[],bufferNames:[]}};var f=0,g=function(a,g,h){e._loadAssets(g,function(d){var g=e.recordData[a];g.bufferList=d,g.totalBuffers=c(g.bufferList);for(var i=0;i<g.totalBuffers;++i)g.totalDuration+=g.bufferList["buffer"+(i+1)].duration;++f,2===f?(e.currentBuffer=1,e.currentSide=1,e.isReady=!0,b()):h()},function(a){var b=0;b=f<1?50*a/100:(a+100)/2,d(b)})},h=function(b){for(var c=[],d={},f=0,g=a.sides[b].length;f<g;++f)d["buffer"+(f+1)]=a.sides[b][f];return c.push(d),e.recordData[b].bufferNames=c,c};g("side1",h("side1"),function(){g("side2",h("side2"))})},g.prototype.start=function(){this.isReady&&(this._play(),this._operate(),this._ctrlPlay("play"))},g.prototype._getCurrentSide=function(){return this.recordData["side"+this.currentSide]},g.prototype._play=function(a){this.source=this.audioCtx.createBufferSource(),this.source.buffer=this._getCurrentSide().bufferList["buffer"+this.currentBuffer],this.infoElems.song.innerHTML=this._getSongName(this._getCurrentSide().bufferNames[0]["buffer"+this.currentBuffer]),this.setEffect(),this.source.start(a&&a>0?this.audioCtx.currentTime:this.audioCtx.currentTime+this.bufferDelay,a?a:0);var b=this;this.analyserTimeout&&clearTimeout(this.analyserTimeout),this.analyserTimeout=setTimeout(function(){b._analyse()},a&&a>0?0:1e3*this.bufferDelay);var b=this;this.sourceEnded=function(){b.isDragging||(b.currentBuffer<b._getCurrentSide().totalBuffers&&b.isPlatterRotating?(b.source.stop(0),b.currentBuffer++,b._play()):b.stop())},this.source.onended=this.sourceEnded},g.prototype._getSongName=function(a){return a.substring(4,a.indexOf(".mp3"))},g.prototype._createAnalyser=function(){this.analyser=this.audioCtx.createAnalyser(),this.canvas=document.createElement("canvas"),this.ui.visualizer.appendChild(this.canvas),this.canvasCtx=this.canvas.getContext("2d"),this.canvasSize={width:this.ui.visualizer.clientWidth,height:this.ui.visualizer.clientHeight},this.canvas.setAttribute("width",this.canvasSize.width),this.canvas.setAttribute("height",this.canvasSize.height)},g.prototype._analyse=function(){a.cancelAnimationFrame(this.drawVisual),this.analyser.fftSize=2048;var b=this.analyser.frequencyBinCount,c=new Uint8Array(b),d=this.canvasSize.width,e=this.canvasSize.height,f=this;this.canvasCtx.clearRect(0,0,d,e);var g=function(){f.drawVisual=requestAnimationFrame(g),f.analyser.getByteTimeDomainData(c),f.canvasCtx.fillStyle="#45bd94",f.canvasCtx.fillRect(0,0,d,e),f.canvasCtx.lineWidth=1,f.canvasCtx.strokeStyle="#474283",f.canvasCtx.beginPath();for(var a=1*d/b,h=0,i=0;i<b;i++){var j=c[i]/128,k=j*e/2;0===i?f.canvasCtx.moveTo(h,k):f.canvasCtx.lineTo(h,k),h+=a}f.canvasCtx.lineTo(d,e/2),f.canvasCtx.stroke()};g()},g.prototype._stopAnalysing=function(){a.cancelAnimationFrame(this.drawVisual),this.canvasCtx.clearRect(0,0,this.canvas.width,this.canvas.height)},g.prototype._operate=function(a,b){var a=a||1;if(this._createNoise(),this._playNoise(),1===a){this._moveArmTo(1);var c=this;this.armtimeout=dynamics.setTimeout(function(){c._animateArm()},1e3*this.bufferDelay),this._startPlatterRotation()}else if(2===a){var c=this;this.armtimeout=dynamics.setTimeout(function(){c._animateArm(b)},b===this.totalDuration?1e3*this.bufferDelay:0)}},g.prototype.stop=function(){this.armtimeout&&dynamics.clearTimeout(this.armtimeout),this.source.removeEventListener("ended",this.sourceEnded),this.source.stop(0),this.currentBuffer=1,this._stopNoise(),this._stopAnalysing(),dynamics.stop(this.ui.arm),this.isDragging||(this._moveArmTo(0),this._stopPlatterRotation(),this._ctrlPlay("stop")),this.analyserTimeout&&clearTimeout(this.analyserTimeout)},g.prototype._resume=function(){if(this.armRotation<this.angleInterval.min||this.armRotation>=this.angleInterval.max)this._moveArmTo(0),this._stopPlatterRotation(),this._ctrlPlay("stop");else{var a=this._getCurrentInfoFromAngle();this.currentBuffer=a.bufferIdx,this._play(a.bufferOffset),this._operate(2,a.remainingTime)}},g.prototype._getCurrentInfoFromAngle=function(){for(var a=-1,b=0,c=0,d=-1,e=this.armRotation*this._getCurrentSide().totalDuration/(this.angleInterval.max-this.angleInterval.min)-this.angleInterval.min*this._getCurrentSide().totalDuration/(this.angleInterval.max-this.angleInterval.min),f=0;f<this._getCurrentSide().totalBuffers;++f){if(b+=this._getCurrentSide().bufferList["buffer"+(f+1)].duration,e<b){a=f+1,d=e-c;break}c=b}return{remainingTime:this._getCurrentSide().totalDuration-e,bufferIdx:a,bufferOffset:d}},g.prototype._createNoise=function(){this.noise=this.audioCtx.createBufferSource(),this.noise.buffer=this.options.noiseBuffer,this.noiseGain=this.audioCtx.createGain(),this.noiseGain.gain.value=this.noiseVal,this.noise.connect(this.noiseGain),this.noiseGain.connect(this.audioCtx.destination),this.noise.loop=!0},g.prototype._playNoise=function(){this.noise.start(0)},g.prototype._stopNoise=function(a){this.noise.stop(0)},g.prototype._adjustNoiseGain=function(a){this.noiseGain&&(this.noiseGain.gain.value=a)},g.prototype.setNoise=function(a){this.noiseVal=a?this.options.noiseGain:0,this._adjustNoiseGain(this.noiseVal)},g.prototype.setEffect=function(a){this.effect=void 0!=a?a:this.effect,this.source&&(this.effect===-1?(this.source.disconnect(),this.convolver.disconnect(),this.source.connect(this.analyser),this.analyser.connect(this.speakers)):(this.convolver.buffer=this.options.effectBuffers[this.effect],this.source.connect(this.analyser),this.analyser.connect(this.convolver),this.convolver.connect(this.speakers)))},g.prototype._getAngle=function(a){var b=a.getBoundingClientRect(),c=this.ui.arm.getBoundingClientRect(),d=b.width/2,f=b.left+b.width/2,g=b.top+b.height/2,h=c.width/2,i=c.left+c.width/2,j=c.top+c.height/2,k=e(f,g,d,i,j,h),l=180*Math.atan2(this.armCenterPoint.y-k.y,this.armCenterPoint.x-k.x)/Math.PI;return l+90-this.cartridgeMargin},g.prototype._moveArmTo=function(a,b){dynamics.stop(this.ui.arm),dynamics.animate(this.ui.arm,{rotateZ:a?this.angleInterval.min:0},{duration:b||1e3,type:dynamics.spring,frequency:200,friction:400}),this.armRotation=a?this.angleInterval.min:0},g.prototype._animateArm=function(a){var b=this,c=this.angleInterval.max,d=this.armRotation>0?this.armRotation:this.angleInterval.min;dynamics.stop(this.ui.arm),dynamics.animate(this.ui.arm,{rotateZ:this.angleInterval.max},{duration:void 0!=a&&a!==this._getCurrentSide().totalDuration?1e3*a:1e3*(this._getCurrentSide().totalDuration+this.bufferDelay),type:dynamics.linear,change:function(a,e){b.armRotation=(c-d)*e+d}})},g.prototype._startPlatterRotation=function(){this.isPlatterRotating=!0,classie.add(this.ui.player,"player__element--lp-spin")},g.prototype._stopPlatterRotation=function(){this.isPlatterRotating=!1,classie.remove(this.ui.player,"player__element--lp-spin")},g.prototype.setRecordInfo=function(a){this.infoElems.artist.innerHTML=a.artist,this.infoElems.title.innerHTML=a.title,this.infoElems.year.innerHTML=a.year},g.prototype._initEvents=function(){var b=this,c=-1,e=0,f=180/Math.PI;this.startDragging=function(){b.isDragging=!0,e=b.armRotation?b.armRotation:e,b.source&&b.stop(),document.addEventListener("mousemove",b.dragging),document.addEventListener("mouseup",b.stopDragging)},this.dragging=function(a){var d=Math.atan2(b.armCenterPoint.y-a.pageY,b.armCenterPoint.x-a.pageX)*f;c&&c!=-1||(c=d);var g=d-c+b.armRotation;g<0?g=0:g>b.angleInterval.max&&(g=b.angleInterval.max),e=g,dynamics.css(b.ui.arm,{rotateZ:e})},this.stopDragging=function(){b.isDragging=!1,document.removeEventListener("mousemove",b.dragging),document.removeEventListener("mouseup",b.stopDragging),b.armRotation=e,c=-1,b.isPlatterRotating&&b._resume()},this.ui.arm.addEventListener("mousedown",this.startDragging),this.debounceResize=d(function(a){var c=b.ui.arm.getBoundingClientRect();b.armCenterPoint={x:c.left+c.width/2,y:c.top+c.height/2},b.angleInterval={min:b._getAngle(b.ui.player),max:b._getAngle(b.ui.recordCover)},b.drawVisual&&(b.canvasSize={width:b.ui.visualizer.clientWidth,height:b.ui.visualizer.clientHeight},b.canvas.setAttribute("width",b.canvasSize.width),b.canvas.setAttribute("height",b.canvasSize.height),b._analyse())},10),a.addEventListener("resize",this.debounceResize),this.ctrls.back.addEventListener("click",function(){b._ctrlBack()}),this.ctrls.play.addEventListener("click",function(){classie.has(b.ctrls.playStatus,"icon--hidden")?(b._ctrlPlay("stop"),b.stop()):(b._ctrlPlay("play"),b.start())}),this.ctrls.vinylFx.addEventListener("click",function(){b._ctrlVinylFx()}),this.ctrls.roomFx.forEach(function(a,c){a.addEventListener("click",function(){b._ctrlRoomFx(a,c)})}),this.ctrls.rotate.addEventListener("click",function(){b._ctrlRotate()}),this.touchStartFix=function(){var c=b.audioCtx.createBuffer(1,1,22050),d=b.audioCtx.createBufferSource();d.buffer=c,d.connect(b.audioCtx.destination),d.start(0),a.removeEventListener("touchstart",b.touchStartFix)},a.addEventListener("touchstart",this.touchStartFix)},g.prototype._ctrlBack=function(){this.stop(),this.options.onGoBack(),classie.has(this.ui.player,"player__element--lp-flip")&&classie.remove(this.ui.player,"player__element--lp-flip")},g.prototype._ctrlPlay=function(a){classie.remove("stop"===a?this.ctrls.playStatus:this.ctrls.stopStatus,"icon--hidden"),classie.add("stop"===a?this.ctrls.stopStatus:this.ctrls.playStatus,"icon--hidden")},g.prototype._ctrlVinylFx=function(){var a=classie.has(this.ctrls.vinylFx,"effects__button--active");this.setNoise(!a),a?classie.remove(this.ctrls.vinylFx,"effects__button--active"):classie.add(this.ctrls.vinylFx,"effects__button--active")},g.prototype._ctrlRoomFx=function(a,b){this.ctrls.roomFx.forEach(function(b){classie.has(b,"effects__button--active")&&b!=a&&classie.remove(b,"effects__button--active")});var c=classie.has(a,"effects__button--active");c?(classie.remove(a,"effects__button--active"),this.setEffect(-1)):(classie.add(a,"effects__button--active"),this.setEffect(b))},g.prototype._ctrlRotate=function(a,b){this.isPlatterRotating&&this.stop(),this.currentSide=1===this.currentSide?2:1,classie.has(this.ui.player,"player__element--lp-flip")?classie.remove(this.ui.player,"player__element--lp-flip"):classie.add(this.ui.player,"player__element--lp-flip")},h.prototype.layout=function(a){switch(a){case"down":dynamics.css(this.cover,{opacity:1,translateY:f.height}),dynamics.css(this.position,{opacity:1,translateY:f.height-200}),dynamics.css(this.artist,{opacity:1,translateY:f.height-200}),dynamics.css(this.title,{opacity:1,translateY:f.height-180}),dynamics.css(this.year,{opacity:1,translateY:f.height-250});break;case"right":dynamics.css(this.cover,{opacity:1,translateX:f.width+600}),dynamics.css(this.position,{opacity:1,translateX:f.width+150}),dynamics.css(this.artist,{opacity:1,translateX:f.width}),dynamics.css(this.title,{opacity:1,translateX:f.width+150}),dynamics.css(this.year,{opacity:1,translateX:f.width+50});break;case"left":dynamics.css(this.cover,{opacity:1,translateX:-f.width-600}),dynamics.css(this.position,{opacity:1,translateX:-f.width-150}),dynamics.css(this.artist,{opacity:1,translateX:-f.width}),dynamics.css(this.title,{opacity:1,translateX:-f.width-150}),dynamics.css(this.year,{opacity:1,translateX:-f.width-50});break;case"hidden":dynamics.css(this.cover,{opacity:0}),dynamics.css(this.position,{opacity:0}),dynamics.css(this.artist,{opacity:0}),dynamics.css(this.title,{opacity:0}),dynamics.css(this.year,{opacity:0})}},h.prototype.animate=function(a,b){var c=600,d=dynamics.bezier,e=[{x:0,y:0,cp:[{x:.2,y:1}]},{x:1,y:1,cp:[{x:.3,y:1}]}],g={left:{translateX:-f.width,translateY:0,opacity:1},right:{translateX:f.width,translateY:0,opacity:1},center:{translateX:0,translateY:0,opacity:1}};dynamics.animate(this.cover,g[a],{duration:c,type:d,points:e,complete:function(){"function"==typeof b&&b()}}),dynamics.animate(this.position,g[a],{duration:c,type:d,points:e}),dynamics.animate(this.artist,g[a],{duration:c,type:d,points:e}),dynamics.animate(this.title,g[a],{duration:c,type:d,points:e}),dynamics.animate(this.year,g[a],{duration:c,type:d,points:e})},i.prototype.options={onStop:function(){return!1},onLoadRecord:function(){return!1},onShowRecord:function(){return!1}},i.prototype.start=function(a){this.current=a;var b=this.records[this.current];classie.add(b.wrapper,"single--current"),b.layout("down"),b.animate("center"),this._showPlayCtrl()},i.prototype.restart=function(a){var b=this.records[this.current];classie.add(b.wrapper,"single--current"),b.layout("left"),b.animate("center",a),this._showPlayCtrl()},i.prototype._initEvents=function(){var a=this;this.ctrls.next.addEventListener("click",function(){a._navigate("right")}),this.ctrls.prev.addEventListener("click",function(){a._navigate("left")}),this.ctrls.back.addEventListener("click",function(){a._stop()}),this.ctrls.play.addEventListener("click",function(){a._loadRecord()})},i.prototype._navigate=function(a){var b=this;this.isLoading&&this._cancelRecordLoading(),this._hidePlayCtrl();var c=this.records[this.current];"right"===a?this.current=this.current<this.recordsTotal-1?this.current+1:0:this.current=this.current>0?this.current-1:this.recordsTotal-1;var d=this.records[this.current];classie.add(d.wrapper,"single--current"),c.animate("right"===a?"left":"right",function(){classie.remove(c.wrapper,"single--current")}),d.layout(a),d.animate("center",function(){b._showPlayCtrl()})},i.prototype._loadRecord=function(){return!this.isLoading&&(classie.add(this.ctrls.play,"control-button--active"),this.isLoading=!0,void this.options.onLoadRecord(this.records[this.current],this.lpPlayCtrlPath,this.lpPlayCtrlPathLen))},i.prototype._showRecord=function(){if(!this.isLoading)return!1;var b=this.records[this.current];b.animate("left",function(){b.layout("hidden"),classie.remove(b.wrapper,"single--current")}),this._hidePlayCtrl(),this.options.onShowRecord(b),this._cancelRecordLoading()},i.prototype._stop=function(){this.isLoading&&this._cancelRecordLoading();var a=this.records[this.current];a.layout("hidden"),classie.remove(a.wrapper,"single--current"),this._hidePlayCtrl(),this.options.onStop()},i.prototype._cancelRecordLoading=function(){this.isLoading=!1,classie.remove(this.ctrls.play,"control-button--active"),dynamics.stop(this.lpPlayCtrlPath),dynamics.css(this.lpPlayCtrlPath,{strokeDasharray:this.lpPlayCtrlPathLen,strokeDashoffset:this.lpPlayCtrlPathLen})},i.prototype._showPlayCtrl=function(){dynamics.animate(this.ctrls.play,{opacity:1},{duration:200,type:dynamics.easeOut})},i.prototype._hidePlayCtrl=function(){dynamics.css(this.ctrls.play,{opacity:0})};var o,p,j={grid:document.querySelector(".view--grid"),single:document.querySelector(".view--single"),player:document.querySelector(".view--player")},k=j.grid.querySelector("ul.grid"),l=[].slice.call(k.querySelectorAll("li.grid__item")),m=document.querySelector(".deco-expander"),n=j.player.querySelector(".player__element--lp");q(),a.AudioContext=a.AudioContext||a.webkitAudioContext}(window);


/*!
 * Masonry PACKAGED v4.0.0
 * Cascading grid layout library
 * http://masonry.desandro.com
 * MIT License
 * by David DeSandro
 */
!function(t,e){"use strict";"function"==typeof define&&define.amd?define("jquery-bridget/jquery-bridget",["jquery"],function(i){e(t,i)}):"object"==typeof module&&module.exports?module.exports=e(t,require("jquery")):t.jQueryBridget=e(t,t.jQuery)}(window,function(t,e){"use strict";function i(i,r,a){function h(t,e,n){var o,r="$()."+i+'("'+e+'")';return t.each(function(t,h){var u=a.data(h,i);if(!u)return void s(i+" not initialized. Cannot call methods, i.e. "+r);var d=u[e];if(!d||"_"==e.charAt(0))return void s(r+" is not a valid method");var c=d.apply(u,n);o=void 0===o?c:o}),void 0!==o?o:t}function u(t,e){t.each(function(t,n){var o=a.data(n,i);o?(o.option(e),o._init()):(o=new r(n,e),a.data(n,i,o))})}a=a||e||t.jQuery,a&&(r.prototype.option||(r.prototype.option=function(t){a.isPlainObject(t)&&(this.options=a.extend(!0,this.options,t))}),a.fn[i]=function(t){if("string"==typeof t){var e=o.call(arguments,1);return h(this,t,e)}return u(this,t),this},n(a))}function n(t){!t||t&&t.bridget||(t.bridget=i)}var o=Array.prototype.slice,r=t.console,s="undefined"==typeof r?function(){}:function(t){r.error(t)};return n(e||t.jQuery),i}),function(t,e){"function"==typeof define&&define.amd?define("ev-emitter/ev-emitter",e):"object"==typeof module&&module.exports?module.exports=e():t.EvEmitter=e()}(this,function(){function t(){}var e=t.prototype;return e.on=function(t,e){if(t&&e){var i=this._events=this._events||{},n=i[t]=i[t]||[];return-1==n.indexOf(e)&&n.push(e),this}},e.once=function(t,e){if(t&&e){this.on(t,e);var i=this._onceEvents=this._onceEvents||{},n=i[t]=i[t]||[];return n[e]=!0,this}},e.off=function(t,e){var i=this._events&&this._events[t];if(i&&i.length){var n=i.indexOf(e);return-1!=n&&i.splice(n,1),this}},e.emitEvent=function(t,e){var i=this._events&&this._events[t];if(i&&i.length){var n=0,o=i[n];e=e||[];for(var r=this._onceEvents&&this._onceEvents[t];o;){var s=r&&r[o];s&&(this.off(t,o),delete r[o]),o.apply(this,e),n+=s?0:1,o=i[n]}return this}},t}),function(t,e){"use strict";"function"==typeof define&&define.amd?define("get-size/get-size",[],function(){return e()}):"object"==typeof module&&module.exports?module.exports=e():t.getSize=e()}(window,function(){"use strict";function t(t){var e=parseFloat(t),i=-1==t.indexOf("%")&&!isNaN(e);return i&&e}function e(){}function i(){for(var t={width:0,height:0,innerWidth:0,innerHeight:0,outerWidth:0,outerHeight:0},e=0;u>e;e++){var i=h[e];t[i]=0}return t}function n(t){var e=getComputedStyle(t);return e||a("Style returned "+e+". Are you running this code in a hidden iframe on Firefox? See http://bit.ly/getsizebug1"),e}function o(){if(!d){d=!0;var e=document.createElement("div");e.style.width="200px",e.style.padding="1px 2px 3px 4px",e.style.borderStyle="solid",e.style.borderWidth="1px 2px 3px 4px",e.style.boxSizing="border-box";var i=document.body||document.documentElement;i.appendChild(e);var o=n(e);r.isBoxSizeOuter=s=200==t(o.width),i.removeChild(e)}}function r(e){if(o(),"string"==typeof e&&(e=document.querySelector(e)),e&&"object"==typeof e&&e.nodeType){var r=n(e);if("none"==r.display)return i();var a={};a.width=e.offsetWidth,a.height=e.offsetHeight;for(var d=a.isBorderBox="border-box"==r.boxSizing,c=0;u>c;c++){var l=h[c],f=r[l],m=parseFloat(f);a[l]=isNaN(m)?0:m}var p=a.paddingLeft+a.paddingRight,g=a.paddingTop+a.paddingBottom,y=a.marginLeft+a.marginRight,v=a.marginTop+a.marginBottom,_=a.borderLeftWidth+a.borderRightWidth,E=a.borderTopWidth+a.borderBottomWidth,z=d&&s,b=t(r.width);b!==!1&&(a.width=b+(z?0:p+_));var x=t(r.height);return x!==!1&&(a.height=x+(z?0:g+E)),a.innerWidth=a.width-(p+_),a.innerHeight=a.height-(g+E),a.outerWidth=a.width+y,a.outerHeight=a.height+v,a}}var s,a="undefined"==typeof console?e:function(t){console.error(t)},h=["paddingLeft","paddingRight","paddingTop","paddingBottom","marginLeft","marginRight","marginTop","marginBottom","borderLeftWidth","borderRightWidth","borderTopWidth","borderBottomWidth"],u=h.length,d=!1;return r}),function(t,e){"use strict";"function"==typeof define&&define.amd?define("matches-selector/matches-selector",e):"object"==typeof module&&module.exports?module.exports=e():t.matchesSelector=e()}(window,function(){"use strict";var t=function(){var t=Element.prototype;if(t.matches)return"matches";if(t.matchesSelector)return"matchesSelector";for(var e=["webkit","moz","ms","o"],i=0;i<e.length;i++){var n=e[i],o=n+"MatchesSelector";if(t[o])return o}}();return function(e,i){return e[t](i)}}),function(t,e){"use strict";"function"==typeof define&&define.amd?define("fizzy-ui-utils/utils",["matches-selector/matches-selector"],function(i){return e(t,i)}):"object"==typeof module&&module.exports?module.exports=e(t,require("desandro-matches-selector")):t.fizzyUIUtils=e(t,t.matchesSelector)}(window,function(t,e){var i={};i.extend=function(t,e){for(var i in e)t[i]=e[i];return t},i.modulo=function(t,e){return(t%e+e)%e},i.makeArray=function(t){var e=[];if(Array.isArray(t))e=t;else if(t&&"number"==typeof t.length)for(var i=0;i<t.length;i++)e.push(t[i]);else e.push(t);return e},i.removeFrom=function(t,e){var i=t.indexOf(e);-1!=i&&t.splice(i,1)},i.getParent=function(t,i){for(;t!=document.body;)if(t=t.parentNode,e(t,i))return t},i.getQueryElement=function(t){return"string"==typeof t?document.querySelector(t):t},i.handleEvent=function(t){var e="on"+t.type;this[e]&&this[e](t)},i.filterFindElements=function(t,n){t=i.makeArray(t);var o=[];return t.forEach(function(t){if(t instanceof HTMLElement){if(!n)return void o.push(t);e(t,n)&&o.push(t);for(var i=t.querySelectorAll(n),r=0;r<i.length;r++)o.push(i[r])}}),o},i.debounceMethod=function(t,e,i){var n=t.prototype[e],o=e+"Timeout";t.prototype[e]=function(){var t=this[o];t&&clearTimeout(t);var e=arguments,r=this;this[o]=setTimeout(function(){n.apply(r,e),delete r[o]},i||100)}},i.docReady=function(t){"complete"==document.readyState?t():document.addEventListener("DOMContentLoaded",t)},i.toDashed=function(t){return t.replace(/(.)([A-Z])/g,function(t,e,i){return e+"-"+i}).toLowerCase()};var n=t.console;return i.htmlInit=function(e,o){i.docReady(function(){var r=i.toDashed(o),s="data-"+r,a=document.querySelectorAll("["+s+"]"),h=document.querySelectorAll(".js-"+r),u=i.makeArray(a).concat(i.makeArray(h)),d=s+"-options",c=t.jQuery;u.forEach(function(t){var i,r=t.getAttribute(s)||t.getAttribute(d);try{i=r&&JSON.parse(r)}catch(a){return void(n&&n.error("Error parsing "+s+" on "+t.className+": "+a))}var h=new e(t,i);c&&c.data(t,o,h)})})},i}),function(t,e){"function"==typeof define&&define.amd?define("outlayer/item",["ev-emitter/ev-emitter","get-size/get-size"],function(i,n){return e(t,i,n)}):"object"==typeof module&&module.exports?module.exports=e(t,require("ev-emitter"),require("get-size")):(t.Outlayer={},t.Outlayer.Item=e(t,t.EvEmitter,t.getSize))}(window,function(t,e,i){"use strict";function n(t){for(var e in t)return!1;return e=null,!0}function o(t,e){t&&(this.element=t,this.layout=e,this.position={x:0,y:0},this._create())}function r(t){return t.replace(/([A-Z])/g,function(t){return"-"+t.toLowerCase()})}var s=document.documentElement.style,a="string"==typeof s.transition?"transition":"WebkitTransition",h="string"==typeof s.transform?"transform":"WebkitTransform",u={WebkitTransition:"webkitTransitionEnd",transition:"transitionend"}[a],d=[h,a,a+"Duration",a+"Property"],c=o.prototype=Object.create(e.prototype);c.constructor=o,c._create=function(){this._transn={ingProperties:{},clean:{},onEnd:{}},this.css({position:"absolute"})},c.handleEvent=function(t){var e="on"+t.type;this[e]&&this[e](t)},c.getSize=function(){this.size=i(this.element)},c.css=function(t){var e=this.element.style;for(var i in t){var n=d[i]||i;e[n]=t[i]}},c.getPosition=function(){var t=getComputedStyle(this.element),e=this.layout._getOption("originLeft"),i=this.layout._getOption("originTop"),n=t[e?"left":"right"],o=t[i?"top":"bottom"],r=this.layout.size,s=-1!=n.indexOf("%")?parseFloat(n)/100*r.width:parseInt(n,10),a=-1!=o.indexOf("%")?parseFloat(o)/100*r.height:parseInt(o,10);s=isNaN(s)?0:s,a=isNaN(a)?0:a,s-=e?r.paddingLeft:r.paddingRight,a-=i?r.paddingTop:r.paddingBottom,this.position.x=s,this.position.y=a},c.layoutPosition=function(){var t=this.layout.size,e={},i=this.layout._getOption("originLeft"),n=this.layout._getOption("originTop"),o=i?"paddingLeft":"paddingRight",r=i?"left":"right",s=i?"right":"left",a=this.position.x+t[o];e[r]=this.getXValue(a),e[s]="";var h=n?"paddingTop":"paddingBottom",u=n?"top":"bottom",d=n?"bottom":"top",c=this.position.y+t[h];e[u]=this.getYValue(c),e[d]="",this.css(e),this.emitEvent("layout",[this])},c.getXValue=function(t){var e=this.layout._getOption("horizontal");return this.layout.options.percentPosition&&!e?t/this.layout.size.width*100+"%":t+"px"},c.getYValue=function(t){var e=this.layout._getOption("horizontal");return this.layout.options.percentPosition&&e?t/this.layout.size.height*100+"%":t+"px"},c._transitionTo=function(t,e){this.getPosition();var i=this.position.x,n=this.position.y,o=parseInt(t,10),r=parseInt(e,10),s=o===this.position.x&&r===this.position.y;if(this.setPosition(t,e),s&&!this.isTransitioning)return void this.layoutPosition();var a=t-i,h=e-n,u={};u.transform=this.getTranslate(a,h),this.transition({to:u,onTransitionEnd:{transform:this.layoutPosition},isCleaning:!0})},c.getTranslate=function(t,e){var i=this.layout._getOption("originLeft"),n=this.layout._getOption("originTop");return t=i?t:-t,e=n?e:-e,"translate3d("+t+"px, "+e+"px, 0)"},c.goTo=function(t,e){this.setPosition(t,e),this.layoutPosition()},c.moveTo=c._transitionTo,c.setPosition=function(t,e){this.position.x=parseInt(t,10),this.position.y=parseInt(e,10)},c._nonTransition=function(t){this.css(t.to),t.isCleaning&&this._removeStyles(t.to);for(var e in t.onTransitionEnd)t.onTransitionEnd[e].call(this)},c._transition=function(t){if(!parseFloat(this.layout.options.transitionDuration))return void this._nonTransition(t);var e=this._transn;for(var i in t.onTransitionEnd)e.onEnd[i]=t.onTransitionEnd[i];for(i in t.to)e.ingProperties[i]=!0,t.isCleaning&&(e.clean[i]=!0);if(t.from){this.css(t.from);var n=this.element.offsetHeight;n=null}this.enableTransition(t.to),this.css(t.to),this.isTransitioning=!0};var l="opacity,"+r(d.transform||"transform");c.enableTransition=function(){this.isTransitioning||(this.css({transitionProperty:l,transitionDuration:this.layout.options.transitionDuration}),this.element.addEventListener(u,this,!1))},c.transition=o.prototype[a?"_transition":"_nonTransition"],c.onwebkitTransitionEnd=function(t){this.ontransitionend(t)},c.onotransitionend=function(t){this.ontransitionend(t)};var f={"-webkit-transform":"transform"};c.ontransitionend=function(t){if(t.target===this.element){var e=this._transn,i=f[t.propertyName]||t.propertyName;if(delete e.ingProperties[i],n(e.ingProperties)&&this.disableTransition(),i in e.clean&&(this.element.style[t.propertyName]="",delete e.clean[i]),i in e.onEnd){var o=e.onEnd[i];o.call(this),delete e.onEnd[i]}this.emitEvent("transitionEnd",[this])}},c.disableTransition=function(){this.removeTransitionStyles(),this.element.removeEventListener(u,this,!1),this.isTransitioning=!1},c._removeStyles=function(t){var e={};for(var i in t)e[i]="";this.css(e)};var m={transitionProperty:"",transitionDuration:""};return c.removeTransitionStyles=function(){this.css(m)},c.removeElem=function(){this.element.parentNode.removeChild(this.element),this.css({display:""}),this.emitEvent("remove",[this])},c.remove=function(){return a&&parseFloat(this.layout.options.transitionDuration)?(this.once("transitionEnd",function(){this.removeElem()}),void this.hide()):void this.removeElem()},c.reveal=function(){delete this.isHidden,this.css({display:""});var t=this.layout.options,e={},i=this.getHideRevealTransitionEndProperty("visibleStyle");e[i]=this.onRevealTransitionEnd,this.transition({from:t.hiddenStyle,to:t.visibleStyle,isCleaning:!0,onTransitionEnd:e})},c.onRevealTransitionEnd=function(){this.isHidden||this.emitEvent("reveal")},c.getHideRevealTransitionEndProperty=function(t){var e=this.layout.options[t];if(e.opacity)return"opacity";for(var i in e)return i},c.hide=function(){this.isHidden=!0,this.css({display:""});var t=this.layout.options,e={},i=this.getHideRevealTransitionEndProperty("hiddenStyle");e[i]=this.onHideTransitionEnd,this.transition({from:t.visibleStyle,to:t.hiddenStyle,isCleaning:!0,onTransitionEnd:e})},c.onHideTransitionEnd=function(){this.isHidden&&(this.css({display:"none"}),this.emitEvent("hide"))},c.destroy=function(){this.css({position:"",left:"",right:"",top:"",bottom:"",transition:"",transform:""})},o}),function(t,e){"use strict";"function"==typeof define&&define.amd?define("outlayer/outlayer",["ev-emitter/ev-emitter","get-size/get-size","fizzy-ui-utils/utils","./item"],function(i,n,o,r){return e(t,i,n,o,r)}):"object"==typeof module&&module.exports?module.exports=e(t,require("ev-emitter"),require("get-size"),require("fizzy-ui-utils"),require("./item")):t.Outlayer=e(t,t.EvEmitter,t.getSize,t.fizzyUIUtils,t.Outlayer.Item)}(window,function(t,e,i,n,o){"use strict";function r(t,e){var i=n.getQueryElement(t);if(!i)return void(a&&a.error("Bad element for "+this.constructor.namespace+": "+(i||t)));this.element=i,h&&(this.$element=h(this.element)),this.options=n.extend({},this.constructor.defaults),this.option(e);var o=++d;this.element.outlayerGUID=o,c[o]=this,this._create();var r=this._getOption("initLayout");r&&this.layout()}function s(t){function e(){t.apply(this,arguments)}return e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e}var a=t.console,h=t.jQuery,u=function(){},d=0,c={};r.namespace="outlayer",r.Item=o,r.defaults={containerStyle:{position:"relative"},initLayout:!0,originLeft:!0,originTop:!0,resize:!0,resizeContainer:!0,transitionDuration:"0.4s",hiddenStyle:{opacity:0,transform:"scale(0.001)"},visibleStyle:{opacity:1,transform:"scale(1)"}};var l=r.prototype;return n.extend(l,e.prototype),l.option=function(t){n.extend(this.options,t)},l._getOption=function(t){var e=this.constructor.compatOptions[t];return e&&void 0!==this.options[e]?this.options[e]:this.options[t]},r.compatOptions={initLayout:"isInitLayout",horizontal:"isHorizontal",layoutInstant:"isLayoutInstant",originLeft:"isOriginLeft",originTop:"isOriginTop",resize:"isResizeBound",resizeContainer:"isResizingContainer"},l._create=function(){this.reloadItems(),this.stamps=[],this.stamp(this.options.stamp),n.extend(this.element.style,this.options.containerStyle);var t=this._getOption("resize");t&&this.bindResize()},l.reloadItems=function(){this.items=this._itemize(this.element.children)},l._itemize=function(t){for(var e=this._filterFindItemElements(t),i=this.constructor.Item,n=[],o=0;o<e.length;o++){var r=e[o],s=new i(r,this);n.push(s)}return n},l._filterFindItemElements=function(t){return n.filterFindElements(t,this.options.itemSelector)},l.getItemElements=function(){return this.items.map(function(t){return t.element})},l.layout=function(){this._resetLayout(),this._manageStamps();var t=this._getOption("layoutInstant"),e=void 0!==t?t:!this._isLayoutInited;this.layoutItems(this.items,e),this._isLayoutInited=!0},l._init=l.layout,l._resetLayout=function(){this.getSize()},l.getSize=function(){this.size=i(this.element)},l._getMeasurement=function(t,e){var n,o=this.options[t];o?("string"==typeof o?n=this.element.querySelector(o):o instanceof HTMLElement&&(n=o),this[t]=n?i(n)[e]:o):this[t]=0},l.layoutItems=function(t,e){t=this._getItemsForLayout(t),this._layoutItems(t,e),this._postLayout()},l._getItemsForLayout=function(t){return t.filter(function(t){return!t.isIgnored})},l._layoutItems=function(t,e){if(this._emitCompleteOnItems("layout",t),t&&t.length){var i=[];t.forEach(function(t){var n=this._getItemLayoutPosition(t);n.item=t,n.isInstant=e||t.isLayoutInstant,i.push(n)},this),this._processLayoutQueue(i)}},l._getItemLayoutPosition=function(){return{x:0,y:0}},l._processLayoutQueue=function(t){t.forEach(function(t){this._positionItem(t.item,t.x,t.y,t.isInstant)},this)},l._positionItem=function(t,e,i,n){n?t.goTo(e,i):t.moveTo(e,i)},l._postLayout=function(){this.resizeContainer()},l.resizeContainer=function(){var t=this._getOption("resizeContainer");if(t){var e=this._getContainerSize();e&&(this._setContainerMeasure(e.width,!0),this._setContainerMeasure(e.height,!1))}},l._getContainerSize=u,l._setContainerMeasure=function(t,e){if(void 0!==t){var i=this.size;i.isBorderBox&&(t+=e?i.paddingLeft+i.paddingRight+i.borderLeftWidth+i.borderRightWidth:i.paddingBottom+i.paddingTop+i.borderTopWidth+i.borderBottomWidth),t=Math.max(t,0),this.element.style[e?"width":"height"]=t+"px"}},l._emitCompleteOnItems=function(t,e){function i(){o.dispatchEvent(t+"Complete",null,[e])}function n(){s++,s==r&&i()}var o=this,r=e.length;if(!e||!r)return void i();var s=0;e.forEach(function(e){e.once(t,n)})},l.dispatchEvent=function(t,e,i){var n=e?[e].concat(i):i;if(this.emitEvent(t,n),h)if(this.$element=this.$element||h(this.element),e){var o=h.Event(e);o.type=t,this.$element.trigger(o,i)}else this.$element.trigger(t,i)},l.ignore=function(t){var e=this.getItem(t);e&&(e.isIgnored=!0)},l.unignore=function(t){var e=this.getItem(t);e&&delete e.isIgnored},l.stamp=function(t){t=this._find(t),t&&(this.stamps=this.stamps.concat(t),t.forEach(this.ignore,this))},l.unstamp=function(t){t=this._find(t),t&&t.forEach(function(t){n.removeFrom(this.stamps,t),this.unignore(t)},this)},l._find=function(t){return t?("string"==typeof t&&(t=this.element.querySelectorAll(t)),t=n.makeArray(t)):void 0},l._manageStamps=function(){this.stamps&&this.stamps.length&&(this._getBoundingRect(),this.stamps.forEach(this._manageStamp,this))},l._getBoundingRect=function(){var t=this.element.getBoundingClientRect(),e=this.size;this._boundingRect={left:t.left+e.paddingLeft+e.borderLeftWidth,top:t.top+e.paddingTop+e.borderTopWidth,right:t.right-(e.paddingRight+e.borderRightWidth),bottom:t.bottom-(e.paddingBottom+e.borderBottomWidth)}},l._manageStamp=u,l._getElementOffset=function(t){var e=t.getBoundingClientRect(),n=this._boundingRect,o=i(t),r={left:e.left-n.left-o.marginLeft,top:e.top-n.top-o.marginTop,right:n.right-e.right-o.marginRight,bottom:n.bottom-e.bottom-o.marginBottom};return r},l.handleEvent=n.handleEvent,l.bindResize=function(){t.addEventListener("resize",this),this.isResizeBound=!0},l.unbindResize=function(){t.removeEventListener("resize",this),this.isResizeBound=!1},l.onresize=function(){this.resize()},n.debounceMethod(r,"onresize",100),l.resize=function(){this.isResizeBound&&this.needsResizeLayout()&&this.layout()},l.needsResizeLayout=function(){var t=i(this.element),e=this.size&&t;return e&&t.innerWidth!==this.size.innerWidth},l.addItems=function(t){var e=this._itemize(t);return e.length&&(this.items=this.items.concat(e)),e},l.appended=function(t){var e=this.addItems(t);e.length&&(this.layoutItems(e,!0),this.reveal(e))},l.prepended=function(t){var e=this._itemize(t);if(e.length){var i=this.items.slice(0);this.items=e.concat(i),this._resetLayout(),this._manageStamps(),this.layoutItems(e,!0),this.reveal(e),this.layoutItems(i)}},l.reveal=function(t){this._emitCompleteOnItems("reveal",t),t&&t.length&&t.forEach(function(t){t.reveal()})},l.hide=function(t){this._emitCompleteOnItems("hide",t),t&&t.length&&t.forEach(function(t){t.hide()})},l.revealItemElements=function(t){var e=this.getItems(t);this.reveal(e)},l.hideItemElements=function(t){var e=this.getItems(t);this.hide(e)},l.getItem=function(t){for(var e=0;e<this.items.length;e++){var i=this.items[e];if(i.element==t)return i}},l.getItems=function(t){t=n.makeArray(t);var e=[];return t.forEach(function(t){var i=this.getItem(t);i&&e.push(i)},this),e},l.remove=function(t){var e=this.getItems(t);this._emitCompleteOnItems("remove",e),e&&e.length&&e.forEach(function(t){t.remove(),n.removeFrom(this.items,t)},this)},l.destroy=function(){var t=this.element.style;t.height="",t.position="",t.width="",this.items.forEach(function(t){t.destroy()}),this.unbindResize();var e=this.element.outlayerGUID;delete c[e],delete this.element.outlayerGUID,h&&h.removeData(this.element,this.constructor.namespace)},r.data=function(t){t=n.getQueryElement(t);var e=t&&t.outlayerGUID;return e&&c[e]},r.create=function(t,e){var i=s(r);return i.defaults=n.extend({},r.defaults),n.extend(i.defaults,e),i.compatOptions=n.extend({},r.compatOptions),i.namespace=t,i.data=r.data,i.Item=s(o),n.htmlInit(i,t),h&&h.bridget&&h.bridget(t,i),i},r.Item=o,r}),function(t,e){"function"==typeof define&&define.amd?define(["outlayer/outlayer","get-size/get-size"],e):"object"==typeof module&&module.exports?module.exports=e(require("outlayer"),require("get-size")):t.Masonry=e(t.Outlayer,t.getSize)}(window,function(t,e){var i=t.create("masonry");return i.compatOptions.fitWidth="isFitWidth",i.prototype._resetLayout=function(){this.getSize(),this._getMeasurement("columnWidth","outerWidth"),this._getMeasurement("gutter","outerWidth"),this.measureColumns(),this.colYs=[];for(var t=0;t<this.cols;t++)this.colYs.push(0);this.maxY=0},i.prototype.measureColumns=function(){if(this.getContainerWidth(),!this.columnWidth){var t=this.items[0],i=t&&t.element;this.columnWidth=i&&e(i).outerWidth||this.containerWidth}var n=this.columnWidth+=this.gutter,o=this.containerWidth+this.gutter,r=o/n,s=n-o%n,a=s&&1>s?"round":"floor";r=Math[a](r),this.cols=Math.max(r,1)},i.prototype.getContainerWidth=function(){var t=this._getOption("fitWidth"),i=t?this.element.parentNode:this.element,n=e(i);this.containerWidth=n&&n.innerWidth},i.prototype._getItemLayoutPosition=function(t){t.getSize();var e=t.size.outerWidth%this.columnWidth,i=e&&1>e?"round":"ceil",n=Math[i](t.size.outerWidth/this.columnWidth);n=Math.min(n,this.cols);for(var o=this._getColGroup(n),r=Math.min.apply(Math,o),s=o.indexOf(r),a={x:this.columnWidth*s,y:r},h=r+t.size.outerHeight,u=this.cols+1-o.length,d=0;u>d;d++)this.colYs[s+d]=h;return a},i.prototype._getColGroup=function(t){if(2>t)return this.colYs;for(var e=[],i=this.cols+1-t,n=0;i>n;n++){var o=this.colYs.slice(n,n+t);e[n]=Math.max.apply(Math,o)}return e},i.prototype._manageStamp=function(t){var i=e(t),n=this._getElementOffset(t),o=this._getOption("originLeft"),r=o?n.left:n.right,s=r+i.outerWidth,a=Math.floor(r/this.columnWidth);a=Math.max(0,a);var h=Math.floor(s/this.columnWidth);h-=s%this.columnWidth?0:1,h=Math.min(this.cols-1,h);for(var u=this._getOption("originTop"),d=(u?n.top:n.bottom)+i.outerHeight,c=a;h>=c;c++)this.colYs[c]=Math.max(d,this.colYs[c])},i.prototype._getContainerSize=function(){this.maxY=Math.max.apply(Math,this.colYs);var t={height:this.maxY};return this._getOption("fitWidth")&&(t.width=this._getContainerFitWidth()),t},i.prototype._getContainerFitWidth=function(){for(var t=0,e=this.cols;--e&&0===this.colYs[e];)t++;return(this.cols-t)*this.columnWidth-this.gutter},i.prototype.needsResizeLayout=function(){var t=this.containerWidth;return this.getContainerWidth(),t!=this.containerWidth},i});

/*!
* twitterFetcher
*/
!function(a){a.fn.twitterFetcher=function(b){if(b=jQuery.extend({avatar:"default",uniqueId:null,widgetid:null,maxTweets:20,enableLinks:!0,showImages:!1,showRetweet:!0,lang:"en",enablePermalink:!1},b),"undefined"==typeof b.widgetid||null===b.widgetid)return console.error("TWITLINE: WIDGETID MUST BE DEFINED!"),!1;var c=a(this);return window.twtCallback=function(d){function f(a){return a.replace(/<b[^>]*>(.*?)<\/b>/gi,function(a,b){return b}).replace(/class=".*?"|data-query-source=".*?"|dir=".*?"|rel=".*?"/gi,"")}var e=function(a){var c=a.replace(/([+\-]\d\d)(\d\d)$/,"$1:$2");i=new Date(c);var d=i.getHours()>9?i.getHours():"0"+i.getHours(),e=i.getMinutes()>9?i.getMinutes():"0"+i.getMinutes(),f=i.getDate()+1>9?i.getDate():"0"+i.getDate(),g=i.getMonth(),h=["Jan","Feb","Mar","Apr","May","Jun","Jul","Ago","Sep","Oct","Nov","Dec"];g="it"===b.lang?month_it[g]:h[g];var i=f+" "+g+" @ "+d+":"+e;return i},g=a(d.body).find('*[data-scribe="component:tweet"]'),h=[],i=[],j=[],k=[],l=[],m=[],n=[],o=[],p=[];g.each(function(){var c=a(this);h.push(c.find("[data-scribe='element:name']").text()),i.push(c.find("[data-scribe='element:user_link']").attr("href"));var d=void 0!=c.find(".retweet-credit").html();if(!b.showRetweet&&d)return!0;var f=c.find('a[data-scribe="element:url"]');return f.length>0&&(f=f.attr("href"),c.find('a[data-scribe="element:url"]').empty().append(f)),k.push(c.find(".timeline-Tweet-text").html()),l.push(c.find(".data-tweet-id")),m.push("default"!==b.avatar?b.avatar:c.find("[data-scribe='element:avatar']").attr("data-src-1x")),p.push(c.find('[data-scribe="element:mini_timestamp"]').attr("href")),j.push(c.find('[data-scribe="element:screen_name"]').html()),n.push(e(c.find(".dt-updated").attr("datetime"))),o.push(""),k.length!==parseInt(b.maxTweets)&&void 0});for(var q='<div class="row">\n',r=0;r<k.length;r++)q+='\n<div class="twt-content col-lg-12 col-md-12">\n<a target="_blank" href="'+i[r]+'">\n'+j[r]+"\n</a>\n&nbsp;-&nbsp;\n",q+=b.enablePermalink===!0?'<a class="permalink" href="'+p[r]+'">\n<span class="twt-date">'+n[r]+"</span>\n</a>\n":'<span class="twt-date">'+n[r]+"</span>\n",q+='<div class="twt-img sdfsd col-lg-12 col-md-12">\n'+f(k[r])+"\n\n",b.showImages===!0&&(q+=o[r]||""),q+="</div>\n",q+="</div>\n\n";q+="</div>",a(q).find("*").removeAttr("data-scribe"),c.append(q)},this.each(function(){var c="https:"===window.location.protocol?"https":"http",d=document.createElement("script");d.type="text/javascript",d.src=c+"://cdn.syndication.twimg.com/widgets/timelines/"+b.widgetid+"?&lang="+(b.lang||"en")+"&callback=twtCallback&suppress_response_codes=true&rnd="+Math.random(),d.onerror=function(){"undefined"!=typeof b.uniqueId&&null!==b.uniqueId||a(window).trigger("twt-error-"+b.uniqueId),console.warn("GET TWITS ERROR!")},d.onload=function(){console.info("GET TWITS OK!")},d.onreadystatechange=function(){console.info("RSC: ",this.status)},document.getElementsByTagName("head")[0].appendChild(d)})}}(jQuery);
 
/*!
Waypoints - 4.0.1
Copyright © 2011-2016 Caleb Troughton
Licensed under the MIT license.
https://github.com/imakewebthings/waypoints/blob/master/licenses.txt
*/
!function(){"use strict";function c(d){if(!d)throw new Error("No options passed to Waypoint constructor");if(!d.element)throw new Error("No element option passed to Waypoint constructor");if(!d.handler)throw new Error("No handler option passed to Waypoint constructor");this.key="waypoint-"+a,this.options=c.Adapter.extend({},c.defaults,d),this.element=this.options.element,this.adapter=new c.Adapter(this.element),this.callback=d.handler,this.axis=this.options.horizontal?"horizontal":"vertical",this.enabled=this.options.enabled,this.triggerPoint=null,this.group=c.Group.findOrCreate({name:this.options.group,axis:this.axis}),this.context=c.Context.findOrCreateByElement(this.options.context),c.offsetAliases[this.options.offset]&&(this.options.offset=c.offsetAliases[this.options.offset]),this.group.add(this),this.context.add(this),b[this.key]=this,a+=1}var a=0,b={};c.prototype.queueTrigger=function(a){this.group.queueTrigger(this,a)},c.prototype.trigger=function(a){this.enabled&&this.callback&&this.callback.apply(this,a)},c.prototype.destroy=function(){this.context.remove(this),this.group.remove(this),delete b[this.key]},c.prototype.disable=function(){return this.enabled=!1,this},c.prototype.enable=function(){return this.context.refresh(),this.enabled=!0,this},c.prototype.next=function(){return this.group.next(this)},c.prototype.previous=function(){return this.group.previous(this)},c.invokeAll=function(a){var c=[];for(var d in b)c.push(b[d]);for(var e=0,f=c.length;e<f;e++)c[e][a]()},c.destroyAll=function(){c.invokeAll("destroy")},c.disableAll=function(){c.invokeAll("disable")},c.enableAll=function(){c.Context.refreshAll();for(var a in b)b[a].enabled=!0;return this},c.refreshAll=function(){c.Context.refreshAll()},c.viewportHeight=function(){return window.innerHeight||document.documentElement.clientHeight},c.viewportWidth=function(){return document.documentElement.clientWidth},c.adapters=[],c.defaults={context:window,continuous:!0,enabled:!0,group:"default",horizontal:!1,offset:0},c.offsetAliases={"bottom-in-view":function(){return this.context.innerHeight()-this.adapter.outerHeight()},"right-in-view":function(){return this.context.innerWidth()-this.adapter.outerWidth()}},window.Waypoint=c}(),function(){"use strict";function a(a){window.setTimeout(a,1e3/60)}function f(a){this.element=a,this.Adapter=d.Adapter,this.adapter=new this.Adapter(a),this.key="waypoint-context-"+b,this.didScroll=!1,this.didResize=!1,this.oldScroll={x:this.adapter.scrollLeft(),y:this.adapter.scrollTop()},this.waypoints={vertical:{},horizontal:{}},a.waypointContextKey=this.key,c[a.waypointContextKey]=this,b+=1,d.windowContext||(d.windowContext=!0,d.windowContext=new f(window)),this.createThrottledScrollHandler(),this.createThrottledResizeHandler()}var b=0,c={},d=window.Waypoint,e=window.onload;f.prototype.add=function(a){var b=a.options.horizontal?"horizontal":"vertical";this.waypoints[b][a.key]=a,this.refresh()},f.prototype.checkEmpty=function(){var a=this.Adapter.isEmptyObject(this.waypoints.horizontal),b=this.Adapter.isEmptyObject(this.waypoints.vertical),d=this.element==this.element.window;a&&b&&!d&&(this.adapter.off(".waypoints"),delete c[this.key])},f.prototype.createThrottledResizeHandler=function(){function b(){a.handleResize(),a.didResize=!1}var a=this;this.adapter.on("resize.waypoints",function(){a.didResize||(a.didResize=!0,d.requestAnimationFrame(b))})},f.prototype.createThrottledScrollHandler=function(){function b(){a.handleScroll(),a.didScroll=!1}var a=this;this.adapter.on("scroll.waypoints",function(){a.didScroll&&!d.isTouch||(a.didScroll=!0,d.requestAnimationFrame(b))})},f.prototype.handleResize=function(){d.Context.refreshAll()},f.prototype.handleScroll=function(){var a={},b={horizontal:{newScroll:this.adapter.scrollLeft(),oldScroll:this.oldScroll.x,forward:"right",backward:"left"},vertical:{newScroll:this.adapter.scrollTop(),oldScroll:this.oldScroll.y,forward:"down",backward:"up"}};for(var c in b){var d=b[c],e=d.newScroll>d.oldScroll,f=e?d.forward:d.backward;for(var g in this.waypoints[c]){var h=this.waypoints[c][g];if(null!==h.triggerPoint){var i=d.oldScroll<h.triggerPoint,j=d.newScroll>=h.triggerPoint,k=i&&j,l=!i&&!j;(k||l)&&(h.queueTrigger(f),a[h.group.id]=h.group)}}}for(var m in a)a[m].flushTriggers();this.oldScroll={x:b.horizontal.newScroll,y:b.vertical.newScroll}},f.prototype.innerHeight=function(){return this.element==this.element.window?d.viewportHeight():this.adapter.innerHeight()},f.prototype.remove=function(a){delete this.waypoints[a.axis][a.key],this.checkEmpty()},f.prototype.innerWidth=function(){return this.element==this.element.window?d.viewportWidth():this.adapter.innerWidth()},f.prototype.destroy=function(){var a=[];for(var b in this.waypoints)for(var c in this.waypoints[b])a.push(this.waypoints[b][c]);for(var d=0,e=a.length;d<e;d++)a[d].destroy()},f.prototype.refresh=function(){var e,a=this.element==this.element.window,b=a?void 0:this.adapter.offset(),c={};this.handleScroll(),e={horizontal:{contextOffset:a?0:b.left,contextScroll:a?0:this.oldScroll.x,contextDimension:this.innerWidth(),oldScroll:this.oldScroll.x,forward:"right",backward:"left",offsetProp:"left"},vertical:{contextOffset:a?0:b.top,contextScroll:a?0:this.oldScroll.y,contextDimension:this.innerHeight(),oldScroll:this.oldScroll.y,forward:"down",backward:"up",offsetProp:"top"}};for(var f in e){var g=e[f];for(var h in this.waypoints[f]){var n,o,p,q,r,i=this.waypoints[f][h],j=i.options.offset,k=i.triggerPoint,l=0,m=null==k;i.element!==i.element.window&&(l=i.adapter.offset()[g.offsetProp]),"function"==typeof j?j=j.apply(i):"string"==typeof j&&(j=parseFloat(j),i.options.offset.indexOf("%")>-1&&(j=Math.ceil(g.contextDimension*j/100))),n=g.contextScroll-g.contextOffset,i.triggerPoint=Math.floor(l+n-j),o=k<g.oldScroll,p=i.triggerPoint>=g.oldScroll,q=o&&p,r=!o&&!p,!m&&q?(i.queueTrigger(g.backward),c[i.group.id]=i.group):!m&&r?(i.queueTrigger(g.forward),c[i.group.id]=i.group):m&&g.oldScroll>=i.triggerPoint&&(i.queueTrigger(g.forward),c[i.group.id]=i.group)}}return d.requestAnimationFrame(function(){for(var a in c)c[a].flushTriggers()}),this},f.findOrCreateByElement=function(a){return f.findByElement(a)||new f(a)},f.refreshAll=function(){for(var a in c)c[a].refresh()},f.findByElement=function(a){return c[a.waypointContextKey]},window.onload=function(){e&&e(),f.refreshAll()},d.requestAnimationFrame=function(b){var c=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||a;c.call(window,b)},d.Context=f}(),function(){"use strict";function a(a,b){return a.triggerPoint-b.triggerPoint}function b(a,b){return b.triggerPoint-a.triggerPoint}function e(a){this.name=a.name,this.axis=a.axis,this.id=this.name+"-"+this.axis,this.waypoints=[],this.clearTriggerQueues(),c[this.axis][this.name]=this}var c={vertical:{},horizontal:{}},d=window.Waypoint;e.prototype.add=function(a){this.waypoints.push(a)},e.prototype.clearTriggerQueues=function(){this.triggerQueues={up:[],down:[],left:[],right:[]}},e.prototype.flushTriggers=function(){for(var c in this.triggerQueues){var d=this.triggerQueues[c],e="up"===c||"left"===c;d.sort(e?b:a);for(var f=0,g=d.length;f<g;f+=1){var h=d[f];(h.options.continuous||f===d.length-1)&&h.trigger([c])}}this.clearTriggerQueues()},e.prototype.next=function(b){this.waypoints.sort(a);var c=d.Adapter.inArray(b,this.waypoints),e=c===this.waypoints.length-1;return e?null:this.waypoints[c+1]},e.prototype.previous=function(b){this.waypoints.sort(a);var c=d.Adapter.inArray(b,this.waypoints);return c?this.waypoints[c-1]:null},e.prototype.queueTrigger=function(a,b){this.triggerQueues[b].push(a)},e.prototype.remove=function(a){var b=d.Adapter.inArray(a,this.waypoints);b>-1&&this.waypoints.splice(b,1)},e.prototype.first=function(){return this.waypoints[0]},e.prototype.last=function(){return this.waypoints[this.waypoints.length-1]},e.findOrCreate=function(a){return c[a.axis][a.name]||new e(a)},d.Group=e}(),function(){"use strict";function c(b){this.$element=a(b)}var a=window.jQuery,b=window.Waypoint;a.each(["innerHeight","innerWidth","off","offset","on","outerHeight","outerWidth","scrollLeft","scrollTop"],function(a,b){c.prototype[b]=function(){var a=Array.prototype.slice.call(arguments);return this.$element[b].apply(this.$element,a)}}),a.each(["extend","inArray","isEmptyObject"],function(b,d){c[d]=a[d]}),b.adapters.push({name:"jquery",Adapter:c}),b.Adapter=c}(),function(){"use strict";function b(b){return function(){var c=[],d=arguments[0];return b.isFunction(arguments[0])&&(d=b.extend({},arguments[1]),d.handler=arguments[0]),this.each(function(){var e=b.extend({},d,{element:this});"string"==typeof e.context&&(e.context=b(this).closest(e.context)[0]),c.push(new a(e))}),c}}var a=window.Waypoint;window.jQuery&&(window.jQuery.fn.waypoint=b(window.jQuery)),window.Zepto&&(window.Zepto.fn.waypoint=b(window.Zepto))}();